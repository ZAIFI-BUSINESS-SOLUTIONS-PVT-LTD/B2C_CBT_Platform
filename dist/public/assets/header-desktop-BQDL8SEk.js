import{a as u,u as g,r as d,ap as v,j as e,aq as w,ar as y,q as S,f as I,k,L as C,av as P,$,A as m,x as A}from"./index-DZwJavMj.js";import{S as F}from"./profile-avatar-DcYwSUwx.js";import{S as T}from"./scroll-area-gLQjepCA.js";import{N as E,F as H,L}from"./notepad-text-Cckp8kc_.js";function z({item:s,currentPath:a,navigate:x}){const r=s.activePattern?s.activePattern.test(a):a===s.to,l=!!s.disabled,i=!!s.lockedForInstitution,n=l||i;return e.jsxs("li",{role:"none",className:"relative",children:[e.jsxs("button",{onClick:()=>{n||(s.onClick?s.onClick():x(s.to))},role:"menuitem","aria-label":s.text,"aria-disabled":n,disabled:n,className:`group w-full flex items-center rounded-lg transition-all duration-200 focus:outline-none px-4 py-3 text-left ${r?"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-600 font-medium shadow-sm":"text-gray-700 hover:bg-blue-50"} ${n?"filter blur-sm opacity-60 cursor-not-allowed":""}`,children:[e.jsx("div",{className:`flex items-center justify-center transition-colors duration-200 group-hover:text-blue-600 mr-3 ${r?"text-blue-600":"text-gray-600"} ${n?"text-gray-400":""}`,children:s.icon}),e.jsx("span",{className:"text-base whitespace-nowrap overflow-hidden flex-1",children:s.text}),s.expandable&&e.jsx("div",{className:`transition-colors duration-200 ${r?"text-blue-600":"text-gray-500"}`,children:s.expanded?e.jsx(P,{className:"h-4 w-4"}):e.jsx($,{className:"h-4 w-4"})})]}),i&&e.jsx("div",{className:"absolute top-2 right-2 bg-gray-800/80 rounded-full p-1.5",children:e.jsx(L,{className:"h-3 w-3 text-white"})})]})}function U(){const[,s]=u(),{student:a}=g(),[x,r]=d.useState([]),[l,i]=d.useState(new Set),n=()=>({Authorization:`Bearer ${A()}`,"Content-Type":"application/json"}),f=async()=>{try{const t=`${m.BASE_URL}${m.ENDPOINTS.CHAT_SESSIONS}`,o=await fetch(t,{headers:n()});if(o.ok){const N=(await o.json()).results||[];r(N)}else console.error("Failed to load sessions:",o.status)}catch(t){console.error("Failed to load chat sessions:",t)}};d.useEffect(()=>{f()},[]);const b="md:left-64";v();const h=(a==null?void 0:a.isInstitutionStudent)===!0,p=!!(a!=null&&a.institution),j=[{to:"/",text:"Home",icon:e.jsx(w,{className:"h-5 w-5"}),activePattern:/^\/$/},{to:"/topics",text:"Test",icon:e.jsx(E,{className:"h-5 w-5"}),activePattern:/^\/topics/,lockedForInstitution:!0},{to:"/institution-tests",text:"Institution Tests",icon:e.jsx(y,{className:"h-5 w-5"}),activePattern:/^\/institution-tests/},{to:"/dashboard",text:"Analysis",icon:e.jsx(H,{className:"h-5 w-5"}),activePattern:/^\/dashboard/},{to:"/chatbot",text:"Chatbot",icon:e.jsx(S,{className:"h-5 w-5"}),activePattern:/^\/chatbot/,onClick:()=>{c.startsWith("/chatbot")?i(t=>{const o=new Set(t);return o.has("chatbot")?o.delete("chatbot"):o.add("chatbot"),o}):(s("/chatbot"),i(t=>new Set([...t,"chatbot"])))},expandable:!0,expanded:l.has("chatbot"),lockedForInstitution:!0}].filter(t=>!(t.text==="Institution Tests"&&!p&&!h)).map(t=>h&&t.lockedForInstitution?{...t,disabled:!1,lockedForInstitution:!0}:t),[c]=u();return d.useEffect(()=>{c.startsWith("/chatbot")&&i(t=>new Set([...t,"chatbot"]))},[c]),e.jsxs(e.Fragment,{children:[e.jsx("header",{className:`flex items-center justify-end fixed top-0 ${b} right-0 z-50 h-20 bg-white border-b transition-all duration-300`,role:"banner",children:e.jsxs("div",{className:"flex items-center justify-end pr-3 space-x-3",children:[e.jsx(I,{variant:"ghost",size:"icon",onClick:()=>s("/payment"),className:"aspect-square bg-orange-100 rounded-full h-12 w-12","aria-label":"Go to Payment",children:e.jsx(k,{className:"h-5 w-5 text-amber-600"})}),e.jsx(F,{})]})}),e.jsxs("aside",{className:"fixed top-0 left-0 h-full bg-white z-40 shadow-md overflow-hidden flex flex-col",style:{width:"256px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},"aria-label":"Main sidebar navigation",children:[e.jsx("div",{className:"flex items-center h-20 mb-2 border-b justify-start px-6",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("img",{src:C,alt:"InzightEd Logo",className:"h-9 pt-1"})})}),e.jsxs("nav",{className:"flex-1 flex flex-col justify-between overflow-y-auto py-4",children:[e.jsxs("div",{className:"px-3",children:[e.jsx("div",{className:"px-3 mb-4",children:e.jsx("span",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Main Menu"})}),e.jsx("ul",{className:"space-y-2",role:"menu",children:j.map(t=>e.jsx(z,{item:t,currentPath:c,navigate:s},t.to))}),l.has("chatbot")&&e.jsx("div",{className:"mt-2",children:e.jsx(T,{className:"max-h-40",children:e.jsx("div",{className:"space-y-1",children:x.map(t=>e.jsx("button",{onClick:()=>s(`/chatbot?session=${t.chatSessionId}`),className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg truncate",children:t.sessionTitle||`Chat ${t.id}`},t.chatSessionId))})})})]}),e.jsx("div",{className:"mt-auto px-3",children:e.jsxs("div",{className:"flex items-center p-3 bg-blue-50 rounded-xl",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-medium text-sm",children:"U"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"User Name"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Role/Institution"})]})]})})]})]})]})}export{U as H};
