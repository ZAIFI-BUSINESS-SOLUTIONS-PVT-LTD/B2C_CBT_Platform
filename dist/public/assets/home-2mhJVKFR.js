import{u as G,a as K,r as l,j as e,C as g,b as y,G as se,c as U,d as J,B as X,e as ae,f as p,g as ne,h as re,i as Y,L as ie,k as le,T as ce,M as oe}from"./index-DO7ipTtv.js";import{S as de}from"./profile-avatar-DVANyC95.js";import{T as xe}from"./timer-CVZko_se.js";import{C as me,S as he,N as ue,H as q,L as ge}from"./share-2-CSPVMjf5.js";import{M as pe}from"./mobile-dock-Ds855vfF.js";import{T as W}from"./trophy-DXzqvxS5.js";import{T as je}from"./target-tuS1hT4-.js";import{A as be}from"./arrow-right-DlLAh1a7.js";import"./notepad-text-BLVCxvgk.js";function fe({analytics:n}){const{student:r}=G(),[,i]=K();return l.useMemo(()=>r?r.fullName&&r.fullName.trim().length>0?r.fullName.trim():r.email&&r.email.includes("@")?r.email.split("@")[0]:"Student":"Student",[r]),e.jsx("div",{className:"text-center",children:e.jsx("div",{children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-3 text-start",children:"Learn about your performance"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(g,{className:"transition-all duration-300 bg-gradient-to-br from-sky-50 via-blue-50 to-white shadow-lg",children:e.jsxs(y,{className:"p-3 text-start",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-900 flex items-baseline gap-2",children:[e.jsx(se,{className:"h-5 w-5 text-blue-900 pt-1"}),n?`${Math.round(n.overallAccuracy??0)} %`:"0 %"]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 font-medium",children:"Your Average Score"})]})}),e.jsx(g,{className:"transition-all duration-300 bg-gradient-to-br from-sky-50 via-blue-50 to-white border-0 shadow-lg",children:e.jsxs(y,{className:"p-3 text-start",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-900 flex items-baseline gap-2",children:[e.jsx(xe,{className:"h-5 w-5 text-blue-900 pt-1"}),n?`${Math.round(n.averageTimePerQuestion??0)} sec.`:"0 sec."]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 font-medium",children:"Avg. Speed /Question"})]})}),e.jsx(g,{className:"transition-all duration-300 bg-gradient-to-br from-sky-50 via-blue-50 to-white border-0 shadow-lg",children:e.jsxs(y,{className:"p-3 text-start",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-900 flex items-baseline gap-2",children:[e.jsx(me,{className:"h-5 w-5 text-blue-900 pt-1"}),n?`${n.uniqueQuestionsAttempted??0}`:"0"]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 font-medium",children:"Questions attended"})]})}),e.jsx(g,{className:"transition-all duration-300 cursor-pointer bg-white border-0 shadow-lg relative overflow-hidden",onClick:()=>i("/dashboard"),children:e.jsx(y,{className:"p-3 text-center flex items-center justify-center h-full relative z-10",children:e.jsxs("a",{role:"link",className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-2",tabIndex:0,onClick:a=>{a.stopPropagation(),i("/dashboard")},onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),i("/dashboard"))},children:["View more ",">>"]})})})]})]})})})}const ye=()=>{const r=(()=>{const i=new Date("2026-05-03"),a=new Date,c=i.getTime()-a.getTime(),d=Math.ceil(c/(1e3*3600*24));return Math.max(0,d)})();return e.jsx("div",{className:"my-3",children:e.jsx(g,{className:"bg-black/70 backdrop-blur-xl shadow-2xl",children:e.jsx(U,{className:"py-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{children:[e.jsx(J,{className:"text-lg font-semibold text-white",children:"NEET 2026"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Exam date: May 3, 2026"})]})}),e.jsx(X,{variant:"secondary",className:"bg-white/10 text-blue-500 border-blue-500 backdrop-blur-sm pt-1",children:r===1?"1 Day Left":`${r} Days Left`})]})})})})},ve=({title:n="Check out my NEET preparation progress!",description:r="I'm preparing for NEET 2026 with InzightEd. Join me on this journey!",url:i=window.location.origin,type:a="app",score:c,subject:d,className:T=""})=>{const[j,b]=l.useState(!1),m=(()=>{switch(a){case"achievement":return{title:`ðŸ† Achievement Unlocked! ${c?`Scored ${c}%`:""}`,description:`I just achieved a milestone in my NEET preparation! ${d?`in ${d}`:""}`,emoji:"ðŸ†"};case"result":return{title:`ðŸ“Š Test Result: ${c?`${c}%`:"Completed"}`,description:`Just completed a ${d||"practice"} test. ${c?`Scored ${c}%!`:"Keep practicing!"} `,emoji:"ðŸ“Š"};case"progress":return{title:"ðŸ“ˆ Study Progress Update",description:`Making great progress in my NEET preparation journey! ${c?`${c}% complete`:""}`,emoji:"ðŸ“ˆ"};default:return{title:n,description:r,emoji:"ðŸŽ¯"}}})(),v=`${m.emoji} ${m.title}

${m.description}

${i}`,N=async()=>{try{await navigator.clipboard.writeText(v),b(!0),setTimeout(()=>b(!1),2e3)}catch(h){console.error("Failed to copy:",h)}},w=async()=>{if("share"in navigator)try{await navigator.share({title:m.title,text:m.description,url:i})}catch(h){console.log("Error sharing:",h)}},k=[{name:"Copy Link",icon:ne,action:N,color:"bg-white/10 border-white/20 text-white hover:bg-white/20",available:!0}];return e.jsx("div",{className:`px-4 mb-3 ${T}`,children:e.jsxs(g,{className:"bg-white backdrop-blur-xl border border-white/10 shadow-2xl",children:[e.jsx(U,{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{children:[e.jsx(J,{className:"text-lg font-semibold text-gray-800",children:"Study with your friends"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Share with your friends and prepare with them together"})]})}),a!=="app"&&e.jsxs(X,{variant:"secondary",className:"bg-white/10 text-white border-white/20",children:[a==="achievement"&&e.jsx(W,{className:"w-3 h-3 mr-1"}),a==="result"&&e.jsx(je,{className:"w-3 h-3 mr-1"}),a==="progress"&&e.jsx(ae,{className:"w-3 h-3 mr-1"}),a.charAt(0).toUpperCase()+a.slice(1)]})]})}),e.jsx(y,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:["share"in navigator&&e.jsxs(p,{variant:"secondary",size:"sm",onClick:w,className:"bg-black text-white",children:[e.jsx(he,{}),"Share with friends"]}),k.map(h=>e.jsxs(p,{variant:"outline",size:"sm",onClick:w,children:[e.jsx(h.icon,{}),"Copy Link"]}))]})})]})})},u=n=>{if(!n)return"just now";try{const r=new Date(n);if(isNaN(r.getTime()))return"just now";const a=Math.floor((new Date().getTime()-r.getTime())/1e3);return a<0||a<60?"just now":a<3600?`${Math.floor(a/60)} minute${Math.floor(a/60)===1?"":"s"} ago`:a<86400?`${Math.floor(a/3600)} hour${Math.floor(a/3600)===1?"":"s"} ago`:a<604800?`${Math.floor(a/86400)} day${Math.floor(a/86400)===1?"":"s"} ago`:a<2592e3?`${Math.floor(a/604800)} week${Math.floor(a/604800)===1?"":"s"} ago`:a<31536e3?`${Math.floor(a/2592e3)} month${Math.floor(a/2592e3)===1?"":"s"} ago`:`${Math.floor(a/31536e3)} year${Math.floor(a/31536e3)===1?"":"s"} ago`}catch(r){return console.warn("Error parsing date for relative time:",n,r),"just now"}},Ne=()=>{const n=new Date;console.log("Testing formatRelativeTime function:"),console.log("Just now:",u(n.toISOString())),console.log("5 minutes ago:",u(new Date(n.getTime()-5*60*1e3).toISOString())),console.log("2 hours ago:",u(new Date(n.getTime()-2*60*60*1e3).toISOString())),console.log("1 day ago:",u(new Date(n.getTime()-24*60*60*1e3).toISOString())),console.log("Invalid date:",u("invalid-date")),console.log("Null:",u(null))},C={container:"p-3 rounded-xl",text:"text-sm",variants:{blue:{container:"bg-gray-200",text:"text-gray-700",accent:"text-blue-600",accentBg:"bg-blue-50"},indigo:{container:"bg-gray-200",text:"text-gray-700",accent:"text-indigo-600",accentBg:"bg-indigo-50"},green:{container:"bg-gray-200",text:"text-gray-700",accent:"text-green-600",accentBg:"bg-green-50"},red:{container:"bg-gray-200",text:"text-gray-700",accent:"text-red-600",accentBg:"bg-red-50"},gray:{container:"bg-gray-200",text:"text-gray-700",accent:"text-gray-600",accentBg:"bg-gray-50"}}},x=({children:n,variant:r,className:i=""})=>{const a=C.variants[r];return e.jsx("div",{className:`${C.container} ${a.container} ${i}`,children:e.jsx("div",{className:`${C.text} ${a.text}`,children:n})})};function De(){var $,M,I,E,A,D,L,R,_,z,B,P,F,H,Q,V,O;const{isAuthenticated:n,loading:r}=G(),[,i]=K();re();const[a,c]=l.useState(0),[d,T]=l.useState(null),[j,b]=l.useState(null);l.useState(!1);const S=l.useRef(null),m=l.useRef(null),v=l.useCallback(()=>{c(t=>(t+1)%4)},[]),N=l.useCallback(()=>{c(t=>(t-1+4)%4)},[]),w=l.useCallback(t=>{b(null),T({x:t.targetTouches[0].clientX,y:t.targetTouches[0].clientY})},[]),k=l.useCallback(t=>{b({x:t.targetTouches[0].clientX,y:t.targetTouches[0].clientY})},[]),h=l.useCallback(()=>{if(!d||!j)return;const t=d.x-j.x,o=d.y-j.y,ee=t>50,te=t<-50;Math.abs(o)>Math.abs(t)||(ee?v():te&&N())},[d,j,v,N]),{data:f}=Y({queryKey:["/api/dashboard/comprehensive-analytics/"],refetchInterval:3e4,enabled:n&&!r}),{data:s}=Y({queryKey:["/api/insights/student/"],refetchInterval:3e4,enabled:n&&!r});if(l.useEffect(()=>{if(m.current){const t=m.current.querySelector(`[data-tab-id="${a}"]`);t&&t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}},[a]),l.useEffect(()=>{var t;Ne(),s&&(console.log("Insights data:",s),console.log("Cache info:",s.cacheInfo),(t=s.cacheInfo)!=null&&t.lastModified&&(console.log("Last modified:",s.cacheInfo.lastModified),console.log("Formatted time:",u(s.cacheInfo.lastModified))))},[s]),!n)return r?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-indigo-50",children:e.jsx("div",{className:"text-center text-sm text-gray-600",children:"Checking authentication..."})}):(i("/login"),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-indigo-50",children:e.jsx("div",{className:"text-center text-sm text-gray-600",children:"Redirecting to login..."})}));const Z=f&&f.totalTests>0;return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("header",{className:"w-full bg-white border-b sticky top-0 z-50",children:e.jsx("div",{className:"w-full mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("img",{src:ie,alt:"InzightEd",className:"h-6 w-auto"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>i("/payment"),className:"aspect-square bg-orange-100 rounded-full h-10 w-10","aria-label":"Go to Payment",children:e.jsx(le,{className:"h-5 w-5 text-amber-600"})}),e.jsx(de,{})]})]})})}),e.jsxs("div",{className:"w-full bg-gray-100",children:[e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-b border-gray-200 bg-gray-50",children:e.jsx("nav",{ref:m,className:"flex overflow-x-auto hide-scrollbar px-4","aria-label":"Tabs",children:[{id:0,label:"Study Plan",icon:ue,color:"text-blue-600"},{id:1,label:"Last Test Recommendations",icon:q,color:"text-indigo-600"},{id:2,label:"Strengths",icon:W,color:"text-green-600"},{id:3,label:"Weaknesses",icon:ce,color:"text-red-600"}].map(t=>e.jsxs("button",{"data-tab-id":t.id,onClick:()=>c(t.id),className:`flex items-center justify-center gap-2 py-3 px-4 border-b-2 font-medium text-sm transition-colors duration-200 active:bg-gray-50 whitespace-nowrap ${a===t.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(t.icon,{className:`h-4 w-4 transition-colors duration-200 ${a===t.id?"text-blue-600":"text-gray-500 hover:text-gray-700"}`}),e.jsx("span",{children:t.label})]},t.id))})}),e.jsx("div",{className:"select-none insights-container relative",children:e.jsx("div",{ref:S,onTouchStart:w,onTouchMove:k,onTouchEnd:h,className:"overflow-hidden",children:e.jsx("div",{className:"p-4 min-h-[120px]",children:Z?e.jsxs(e.Fragment,{children:[a===0&&e.jsx("div",{className:"space-y-3",children:(I=(M=($=s==null?void 0:s.data)==null?void 0:$.llmInsights)==null?void 0:M.studyPlan)!=null&&I.insights?e.jsx("div",{className:"space-y-3",children:s.data.llmInsights.studyPlan.insights.length>0&&(()=>{const t=s.data.llmInsights.studyPlan.insights[0];return e.jsx(x,{variant:"blue",children:(t==null?void 0:t.text)??t},(t==null?void 0:t.id)??t)})()}):(E=s==null?void 0:s.data)!=null&&E.improvementTopics&&s.data.improvementTopics.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-700 mb-2",children:"Recommended focus areas:"}),e.jsx("ul",{className:"space-y-1 text-xs",children:s.data.improvementTopics.slice(0,3).map((t,o)=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:t.topic}),e.jsxs("span",{className:"text-blue-600",children:[t.accuracy,"%"]})]},o))})]}):(A=s==null?void 0:s.data)!=null&&A.weakTopics&&s.data.weakTopics.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-700 mb-2",children:"Focus on improving these areas:"}),e.jsx("ul",{className:"space-y-1 text-xs",children:s.data.weakTopics.slice(0,2).map((t,o)=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:t.topic}),e.jsxs("span",{className:"text-red-600",children:[t.accuracy,"%"]})]},o))})]}):e.jsx("div",{className:"space-y-2",children:e.jsx(x,{variant:"blue",children:"Take some tests to get AI-generated study plans!"})})}),a===1&&e.jsx("div",{className:"space-y-2",children:(R=(L=(D=s==null?void 0:s.data)==null?void 0:D.llmInsights)==null?void 0:L.lastTestFeedback)!=null&&R.insights?e.jsx("div",{className:"space-y-2",children:s.data.llmInsights.lastTestFeedback.insights.length>0&&(()=>{const t=s.data.llmInsights.lastTestFeedback.insights[0];return e.jsx(x,{variant:"indigo",children:(t==null?void 0:t.text)??t},(t==null?void 0:t.id)??t)})()}):(_=s==null?void 0:s.data)!=null&&_.lastTestTopics&&s.data.lastTestTopics.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-indigo-700 mb-2",children:"Recent test performance:"}),e.jsx("ul",{className:"space-y-1 text-xs",children:s.data.lastTestTopics.slice(0,3).map((t,o)=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:t.topic}),e.jsxs("span",{className:"text-indigo-600",children:[t.accuracy,"%"]})]},o))})]}):e.jsx("div",{className:"space-y-2",children:e.jsx(x,{variant:"indigo",children:"Complete a test to get AI feedback on your performance!"})})}),a===2&&e.jsx("div",{className:"space-y-2",children:!f||f.totalTests===0?e.jsx("div",{className:"space-y-2",children:e.jsx(x,{variant:"gray",children:"Complete practice tests to unlock your strengths!"})}):(P=(B=(z=s==null?void 0:s.data)==null?void 0:z.llmInsights)==null?void 0:B.strengths)!=null&&P.insights?e.jsx("div",{className:"space-y-2",children:s.data.llmInsights.strengths.insights.length>0&&(()=>{const t=s.data.llmInsights.strengths.insights[0];return e.jsx(x,{variant:"green",children:(t==null?void 0:t.text)??t},(t==null?void 0:t.id)??t)})()}):(F=s==null?void 0:s.data)!=null&&F.strengthTopics&&s.data.strengthTopics.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-700 mb-2",children:"Your top performing topics:"}),e.jsx("ul",{className:"space-y-1 text-xs",children:s.data.strengthTopics.slice(0,3).map((t,o)=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:t.topic}),e.jsxs("span",{className:"text-green-600",children:[t.accuracy,"%"]})]},o))})]}):e.jsx("div",{className:"space-y-2",children:e.jsx(x,{variant:"green",children:"Take some tests to get AI analysis of your strengths!"})})}),a===3&&e.jsx("div",{className:"space-y-2",children:(V=(Q=(H=s==null?void 0:s.data)==null?void 0:H.llmInsights)==null?void 0:Q.weaknesses)!=null&&V.insights?e.jsx("div",{className:"space-y-2",children:s.data.llmInsights.weaknesses.insights.length>0&&(()=>{const t=s.data.llmInsights.weaknesses.insights[0];return e.jsx(x,{variant:"red",children:(t==null?void 0:t.text)??t},(t==null?void 0:t.id)??t)})()}):(O=s==null?void 0:s.data)!=null&&O.weakTopics&&s.data.weakTopics.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-700 mb-2",children:"Topics needing focus:"}),e.jsx("ul",{className:"space-y-1 text-xs",children:s.data.weakTopics.slice(0,3).map((t,o)=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:t.topic}),e.jsxs("span",{className:"text-red-600",children:[t.accuracy,"%"]})]},o))})]}):e.jsx("div",{className:"space-y-2",children:e.jsx(x,{variant:"red",children:"Take some tests to get AI analysis of your weaknesses!"})})})]}):e.jsx("div",{className:"space-y-3",children:e.jsx(x,{variant:a===0?"blue":a===1?"indigo":a===2?"green":"red",children:e.jsxs("div",{className:"flex flex-col  justify-center items-center gap-3",children:[e.jsx("div",{children:e.jsx(ge,{className:"h-16 w-16 text-gray-400"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-semibold",children:"Get personalized insights"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Take your first practice test to unlock AI study plans, strengths and weaknesses analysis."})]}),e.jsx("div",{className:"flex",children:e.jsx(p,{variant:"default",size:"lg",onClick:()=>i("/topics"),className:"w-full rounded-lg font-bold","aria-label":"Take a Test",children:"Take Unlimited Mock Tests"})})]})})})})})})]}),e.jsxs("div",{className:"pb-20 bg-white rounded-t-3xl w-full shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1),0_10px_15px_-3px_rgba(0,0,0,0.1),0_4px_6px_-2px_rgba(0,0,0,0.05)]",children:[e.jsx("div",{className:"px-4 py-4",children:e.jsx(oe,{className:"max-w-full"})}),e.jsx("div",{className:"px-4 pb-4 pt-4",children:e.jsx(fe,{analytics:f})}),e.jsx("div",{className:"px-4",children:e.jsx("div",{children:e.jsxs(p,{variant:"default",size:"lg",onClick:()=>i("/topics"),"aria-label":"View Test ArrowRight",className:"w-full rounded-xl font-bold",children:["Take a Test",e.jsx(be,{className:"h-4 w-4 ml-2"})]})})}),e.jsx("div",{className:"px-4 mt-3 mb-4 ",children:e.jsx("div",{children:e.jsxs(p,{variant:"outline",size:"lg",onClick:()=>i("/topics"),"aria-label":"View Test History",className:"w-full rounded-xl border border-blue-500 bg-blue-50 text-blue-600",children:["View Test History",e.jsx(q,{className:"h-4 w-4 ml-2"})]})})}),e.jsxs("div",{className:"px-4 pb-4 pt-8",children:[e.jsx("h1",{className:"text-xl font-bold mb-4",children:"More from InzightEd"}),e.jsx(ye,{})]}),e.jsx(ve,{type:"app"})]})]}),e.jsx(pe,{})]})}export{De as default};
