import{u as U,a as K,r as o,j as e,C as g,b as w,G as ne,c as J,d as X,B as W,e as re,f as p,g as le,h as ce,i as Y,L as oe,k as de,T as xe,M as me}from"./index-D0_LpoOS.js";import{S as he}from"./profile-avatar-D3iRSJzO.js";import{T as ue}from"./timer-BUxsc4uR.js";import{C as ge,S as pe,N as je,H as q}from"./share-2-NbH3wR12.js";import{M as be}from"./mobile-dock-C_psFd5w.js";import{T as Z}from"./trophy-DRb042JG.js";import{T as fe}from"./target-hK32z5Hz.js";import{L as G}from"./notepad-text-BSluFLZW.js";import{A as ye}from"./arrow-right-CZqWqP1f.js";function Ne({analytics:i}){const{student:n}=U(),[,r]=K();return o.useMemo(()=>n?n.fullName&&n.fullName.trim().length>0?n.fullName.trim():n.email&&n.email.includes("@")?n.email.split("@")[0]:"Student":"Student",[n]),e.jsx("div",{className:"text-center",children:e.jsx("div",{children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-3 text-start",children:"Learn about your performance"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(g,{className:"transition-all duration-300 bg-gradient-to-br from-sky-50 via-blue-50 to-white shadow-lg",children:e.jsxs(w,{className:"p-3 text-start",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-900 flex items-baseline gap-2",children:[e.jsx(ne,{className:"h-5 w-5 text-blue-900 pt-1"}),i?`${Math.round(i.overallAccuracy??0)} %`:"0 %"]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 font-medium",children:"Your Average Score"})]})}),e.jsx(g,{className:"transition-all duration-300 bg-gradient-to-br from-sky-50 via-blue-50 to-white border-0 shadow-lg",children:e.jsxs(w,{className:"p-3 text-start",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-900 flex items-baseline gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-blue-900 pt-1"}),i?`${Math.round(i.averageTimePerQuestion??0)} sec.`:"0 sec."]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 font-medium",children:"Avg. Speed /Question"})]})}),e.jsx(g,{className:"transition-all duration-300 bg-gradient-to-br from-sky-50 via-blue-50 to-white border-0 shadow-lg",children:e.jsxs(w,{className:"p-3 text-start",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-900 flex items-baseline gap-2",children:[e.jsx(ge,{className:"h-5 w-5 text-blue-900 pt-1"}),i?`${i.uniqueQuestionsAttempted??0}`:"0"]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 font-medium",children:"Questions attended"})]})}),e.jsx(g,{className:"transition-all duration-300 cursor-pointer bg-white border-0 shadow-lg relative overflow-hidden",onClick:()=>r("/dashboard"),children:e.jsx(w,{className:"p-3 text-center flex items-center justify-center h-full relative z-10",children:e.jsxs("a",{role:"link",className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-2",tabIndex:0,onClick:a=>{a.stopPropagation(),r("/dashboard")},onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),r("/dashboard"))},children:["View more ",">>"]})})})]})]})})})}const ve=()=>{const n=(()=>{const r=new Date("2026-05-03"),a=new Date,l=r.getTime()-a.getTime(),c=Math.ceil(l/(1e3*3600*24));return Math.max(0,c)})();return e.jsx("div",{className:"my-3",children:e.jsx(g,{className:"bg-black/70 backdrop-blur-xl shadow-2xl",children:e.jsx(J,{className:"py-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{children:[e.jsx(X,{className:"text-lg font-semibold text-white",children:"NEET 2026"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Exam date: May 3, 2026"})]})}),e.jsx(W,{variant:"secondary",className:"bg-white/10 text-blue-500 border-blue-500 backdrop-blur-sm pt-1",children:n===1?"1 Day Left":`${n} Days Left`})]})})})})},we=({title:i="Check out my NEET preparation progress!",description:n="I'm preparing for NEET 2026 with InzightEd. Join me on this journey!",url:r=window.location.origin,type:a="app",score:l,subject:c,className:j=""})=>{const[b,T]=o.useState(!1),m=(()=>{switch(a){case"achievement":return{title:`ðŸ† Achievement Unlocked! ${l?`Scored ${l}%`:""}`,description:`I just achieved a milestone in my NEET preparation! ${c?`in ${c}`:""}`,emoji:"ðŸ†"};case"result":return{title:`ðŸ“Š Test Result: ${l?`${l}%`:"Completed"}`,description:`Just completed a ${c||"practice"} test. ${l?`Scored ${l}%!`:"Keep practicing!"} `,emoji:"ðŸ“Š"};case"progress":return{title:"ðŸ“ˆ Study Progress Update",description:`Making great progress in my NEET preparation journey! ${l?`${l}% complete`:""}`,emoji:"ðŸ“ˆ"};default:return{title:i,description:n,emoji:"ðŸŽ¯"}}})(),C=`${m.emoji} ${m.title}

${m.description}

${r}`,y=async()=>{try{await navigator.clipboard.writeText(C),T(!0),setTimeout(()=>T(!1),2e3)}catch(h){console.error("Failed to copy:",h)}},N=async()=>{if("share"in navigator)try{await navigator.share({title:m.title,text:m.description,url:r})}catch(h){console.log("Error sharing:",h)}},k=[{name:"Copy Link",icon:le,action:y,color:"bg-white/10 border-white/20 text-white hover:bg-white/20",available:!0}];return e.jsx("div",{className:`px-4 mb-3 ${j}`,children:e.jsxs(g,{className:"bg-white backdrop-blur-xl border border-white/10 shadow-2xl",children:[e.jsx(J,{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{children:[e.jsx(X,{className:"text-lg font-semibold text-gray-800",children:"Study with your friends"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Share with your friends and prepare with them together"})]})}),a!=="app"&&e.jsxs(W,{variant:"secondary",className:"bg-white/10 text-white border-white/20",children:[a==="achievement"&&e.jsx(Z,{className:"w-3 h-3 mr-1"}),a==="result"&&e.jsx(fe,{className:"w-3 h-3 mr-1"}),a==="progress"&&e.jsx(re,{className:"w-3 h-3 mr-1"}),a.charAt(0).toUpperCase()+a.slice(1)]})]})}),e.jsx(w,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:["share"in navigator&&e.jsxs(p,{variant:"secondary",size:"sm",onClick:N,className:"bg-black text-white",children:[e.jsx(pe,{}),"Share with friends"]}),k.map(h=>e.jsxs(p,{variant:"outline",size:"sm",onClick:N,children:[e.jsx(h.icon,{}),"Copy Link"]}))]})})]})})},u=i=>{if(!i)return"just now";try{const n=new Date(i);if(isNaN(n.getTime()))return"just now";const a=Math.floor((new Date().getTime()-n.getTime())/1e3);return a<0||a<60?"just now":a<3600?`${Math.floor(a/60)} minute${Math.floor(a/60)===1?"":"s"} ago`:a<86400?`${Math.floor(a/3600)} hour${Math.floor(a/3600)===1?"":"s"} ago`:a<604800?`${Math.floor(a/86400)} day${Math.floor(a/86400)===1?"":"s"} ago`:a<2592e3?`${Math.floor(a/604800)} week${Math.floor(a/604800)===1?"":"s"} ago`:a<31536e3?`${Math.floor(a/2592e3)} month${Math.floor(a/2592e3)===1?"":"s"} ago`:`${Math.floor(a/31536e3)} year${Math.floor(a/31536e3)===1?"":"s"} ago`}catch(n){return console.warn("Error parsing date for relative time:",i,n),"just now"}},Te=()=>{const i=new Date;console.log("Testing formatRelativeTime function:"),console.log("Just now:",u(i.toISOString())),console.log("5 minutes ago:",u(new Date(i.getTime()-5*60*1e3).toISOString())),console.log("2 hours ago:",u(new Date(i.getTime()-2*60*60*1e3).toISOString())),console.log("1 day ago:",u(new Date(i.getTime()-24*60*60*1e3).toISOString())),console.log("Invalid date:",u("invalid-date")),console.log("Null:",u(null))},S={container:"p-3 rounded-xl",text:"text-sm",variants:{blue:{container:"bg-gray-200",text:"text-gray-700",accent:"text-blue-600",accentBg:"bg-blue-50"},indigo:{container:"bg-gray-200",text:"text-gray-700",accent:"text-indigo-600",accentBg:"bg-indigo-50"},green:{container:"bg-gray-200",text:"text-gray-700",accent:"text-green-600",accentBg:"bg-green-50"},red:{container:"bg-gray-200",text:"text-gray-700",accent:"text-red-600",accentBg:"bg-red-50"},gray:{container:"bg-gray-200",text:"text-gray-700",accent:"text-gray-600",accentBg:"bg-gray-50"}}},x=({children:i,variant:n,className:r=""})=>{const a=S.variants[n];return e.jsx("div",{className:`${S.container} ${a.container} ${r}`,children:e.jsx("div",{className:`${S.text} ${a.text}`,children:i})})};function Re(){var $,M,I,E,D,A,L,R,_,z,P,B,F,H,O,Q,V;const{isAuthenticated:i,loading:n,student:r}=U(),[,a]=K();ce();const l=!!(r!=null&&r.institution);o.useEffect(()=>{console.log("ðŸ« Institution check:",{student:r,hasInstitution:l,institutionData:r==null?void 0:r.institution})},[r,l]);const[c,j]=o.useState(0),[b,T]=o.useState(null),[f,m]=o.useState(null);o.useState(!1);const C=o.useRef(null),y=o.useRef(null),N=o.useCallback(()=>{j(s=>(s+1)%4)},[]),k=o.useCallback(()=>{j(s=>(s-1+4)%4)},[]),h=o.useCallback(s=>{m(null),T({x:s.targetTouches[0].clientX,y:s.targetTouches[0].clientY})},[]),ee=o.useCallback(s=>{m({x:s.targetTouches[0].clientX,y:s.targetTouches[0].clientY})},[]),se=o.useCallback(()=>{if(!b||!f)return;const s=b.x-f.x,d=b.y-f.y,ae=s>50,ie=s<-50;Math.abs(d)>Math.abs(s)||(ae?N():ie&&k())},[b,f,N,k]),{data:v}=Y({queryKey:["/api/dashboard/comprehensive-analytics/"],refetchInterval:3e4,enabled:i&&!n}),{data:t}=Y({queryKey:["/api/insights/student/"],refetchInterval:3e4,enabled:i&&!n});if(o.useEffect(()=>{if(y.current){const s=y.current.querySelector(`[data-tab-id="${c}"]`);s&&s.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}},[c]),o.useEffect(()=>{var s;Te(),t&&(console.log("Insights data:",t),console.log("Cache info:",t.cacheInfo),(s=t.cacheInfo)!=null&&s.lastModified&&(console.log("Last modified:",t.cacheInfo.lastModified),console.log("Formatted time:",u(t.cacheInfo.lastModified))))},[t]),!i)return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-indigo-50",children:e.jsx("div",{className:"text-center text-sm text-gray-600",children:"Checking authentication..."})}):(a("/login"),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-indigo-50",children:e.jsx("div",{className:"text-center text-sm text-gray-600",children:"Redirecting to login..."})}));const te=v&&v.totalTests>0;return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("header",{className:"w-full bg-white border-b sticky top-0 z-50",children:e.jsx("div",{className:"w-full mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("img",{src:oe,alt:"InzightEd",className:"h-6 w-auto"}),l&&e.jsx("span",{className:"text-xs bg-red-500 text-white px-2 py-1 rounded",children:"INSTITUTION"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>a("/payment"),className:"aspect-square bg-orange-100 rounded-full h-10 w-10","aria-label":"Go to Payment",children:e.jsx(de,{className:"h-5 w-5 text-amber-600"})}),e.jsx(he,{})]})]})})}),e.jsxs("div",{className:"w-full bg-gray-100 relative",children:[l&&e.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-white/60 backdrop-blur-sm min-h-screen",children:e.jsx("div",{className:"bg-white p-8 rounded-2xl shadow-2xl border-2 border-gray-300 max-w-md mx-4",children:e.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[e.jsx("div",{className:"bg-gray-100 p-4 rounded-full",children:e.jsx(G,{className:"h-16 w-16 text-gray-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-xl text-gray-900 mb-2"}),e.jsx("p",{className:"text-base text-gray-600 leading-relaxed",children:"This feature is not available for institution-enrolled students. Please access your institution-specific tests and resources."})]})]})})}),e.jsxs("div",{className:l?"blur-lg pointer-events-none select-none":"","aria-hidden":l,children:[e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-b border-gray-200 bg-gray-50",children:e.jsx("nav",{ref:y,className:"flex overflow-x-auto hide-scrollbar px-4","aria-label":"Tabs",children:[{id:0,label:"Study Plan",icon:je,color:"text-blue-600"},{id:1,label:"Last Test Recommendations",icon:q,color:"text-indigo-600"},{id:2,label:"Strengths",icon:Z,color:"text-green-600"},{id:3,label:"Weaknesses",icon:xe,color:"text-red-600"}].map(s=>e.jsxs("button",{"data-tab-id":s.id,onClick:()=>j(s.id),className:`flex items-center justify-center gap-2 py-3 px-4 border-b-2 font-medium text-sm transition-colors duration-200 active:bg-gray-50 whitespace-nowrap ${c===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(s.icon,{className:`h-4 w-4 transition-colors duration-200 ${c===s.id?"text-blue-600":"text-gray-500 hover:text-gray-700"}`}),e.jsx("span",{children:s.label})]},s.id))})}),e.jsx("div",{className:"select-none insights-container relative",children:e.jsx("div",{ref:C,onTouchStart:h,onTouchMove:ee,onTouchEnd:se,className:"overflow-hidden",children:e.jsx("div",{className:"p-4 min-h-[120px]",children:te?e.jsxs(e.Fragment,{children:[c===0&&e.jsx("div",{className:"space-y-3",children:(I=(M=($=t==null?void 0:t.data)==null?void 0:$.llmInsights)==null?void 0:M.studyPlan)!=null&&I.insights?e.jsx("div",{className:"space-y-3",children:t.data.llmInsights.studyPlan.insights.length>0&&(()=>{const s=t.data.llmInsights.studyPlan.insights[0];return e.jsx(x,{variant:"blue",children:(s==null?void 0:s.text)??s},(s==null?void 0:s.id)??s)})()}):(E=t==null?void 0:t.data)!=null&&E.improvementTopics&&t.data.improvementTopics.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-700 mb-2",children:"Recommended focus areas:"}),e.jsx("ul",{className:"space-y-1 text-xs",children:t.data.improvementTopics.slice(0,3).map((s,d)=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:s.topic}),e.jsxs("span",{className:"text-blue-600",children:[s.accuracy,"%"]})]},d))})]}):(D=t==null?void 0:t.data)!=null&&D.weakTopics&&t.data.weakTopics.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-700 mb-2",children:"Focus on improving these areas:"}),e.jsx("ul",{className:"space-y-1 text-xs",children:t.data.weakTopics.slice(0,2).map((s,d)=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:s.topic}),e.jsxs("span",{className:"text-red-600",children:[s.accuracy,"%"]})]},d))})]}):e.jsx("div",{className:"space-y-2",children:e.jsx(x,{variant:"blue",children:"Take some tests to get AI-generated study plans!"})})}),c===1&&e.jsx("div",{className:"space-y-2",children:(R=(L=(A=t==null?void 0:t.data)==null?void 0:A.llmInsights)==null?void 0:L.lastTestFeedback)!=null&&R.insights?e.jsx("div",{className:"space-y-2",children:t.data.llmInsights.lastTestFeedback.insights.length>0&&(()=>{const s=t.data.llmInsights.lastTestFeedback.insights[0];return e.jsx(x,{variant:"indigo",children:(s==null?void 0:s.text)??s},(s==null?void 0:s.id)??s)})()}):(_=t==null?void 0:t.data)!=null&&_.lastTestTopics&&t.data.lastTestTopics.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-indigo-700 mb-2",children:"Recent test performance:"}),e.jsx("ul",{className:"space-y-1 text-xs",children:t.data.lastTestTopics.slice(0,3).map((s,d)=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:s.topic}),e.jsxs("span",{className:"text-indigo-600",children:[s.accuracy,"%"]})]},d))})]}):e.jsx("div",{className:"space-y-2",children:e.jsx(x,{variant:"indigo",children:"Complete a test to get AI feedback on your performance!"})})}),c===2&&e.jsx("div",{className:"space-y-2",children:!v||v.totalTests===0?e.jsx("div",{className:"space-y-2",children:e.jsx(x,{variant:"gray",children:"Complete practice tests to unlock your strengths!"})}):(B=(P=(z=t==null?void 0:t.data)==null?void 0:z.llmInsights)==null?void 0:P.strengths)!=null&&B.insights?e.jsx("div",{className:"space-y-2",children:t.data.llmInsights.strengths.insights.length>0&&(()=>{const s=t.data.llmInsights.strengths.insights[0];return e.jsx(x,{variant:"green",children:(s==null?void 0:s.text)??s},(s==null?void 0:s.id)??s)})()}):(F=t==null?void 0:t.data)!=null&&F.strengthTopics&&t.data.strengthTopics.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-700 mb-2",children:"Your top performing topics:"}),e.jsx("ul",{className:"space-y-1 text-xs",children:t.data.strengthTopics.slice(0,3).map((s,d)=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:s.topic}),e.jsxs("span",{className:"text-green-600",children:[s.accuracy,"%"]})]},d))})]}):e.jsx("div",{className:"space-y-2",children:e.jsx(x,{variant:"green",children:"Take some tests to get AI analysis of your strengths!"})})}),c===3&&e.jsx("div",{className:"space-y-2",children:(Q=(O=(H=t==null?void 0:t.data)==null?void 0:H.llmInsights)==null?void 0:O.weaknesses)!=null&&Q.insights?e.jsx("div",{className:"space-y-2",children:t.data.llmInsights.weaknesses.insights.length>0&&(()=>{const s=t.data.llmInsights.weaknesses.insights[0];return e.jsx(x,{variant:"red",children:(s==null?void 0:s.text)??s},(s==null?void 0:s.id)??s)})()}):(V=t==null?void 0:t.data)!=null&&V.weakTopics&&t.data.weakTopics.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-700 mb-2",children:"Topics needing focus:"}),e.jsx("ul",{className:"space-y-1 text-xs",children:t.data.weakTopics.slice(0,3).map((s,d)=>e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:s.topic}),e.jsxs("span",{className:"text-red-600",children:[s.accuracy,"%"]})]},d))})]}):e.jsx("div",{className:"space-y-2",children:e.jsx(x,{variant:"red",children:"Take some tests to get AI analysis of your weaknesses!"})})})]}):e.jsx("div",{className:"space-y-3",children:e.jsx(x,{variant:c===0?"blue":c===1?"indigo":c===2?"green":"red",children:e.jsxs("div",{className:"flex flex-col  justify-center items-center gap-3",children:[e.jsx("div",{children:e.jsx(G,{className:"h-16 w-16 text-gray-400"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-semibold",children:"Get personalized insights"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Take your first practice test to unlock AI study plans, strengths and weaknesses analysis."})]}),e.jsx("div",{className:"flex",children:e.jsx(p,{variant:"default",size:"lg",onClick:()=>a("/topics"),className:"w-full rounded-lg font-bold","aria-label":"Take a Test",children:"Take Unlimited Mock Tests"})})]})})})})})})]}),e.jsxs("div",{className:"pb-20 bg-white rounded-t-3xl w-full shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1),0_10px_15px_-3px_rgba(0,0,0,0.1),0_4px_6px_-2px_rgba(0,0,0,0.05)]",children:[e.jsx("div",{className:"px-4 py-4",children:e.jsx(me,{className:"max-w-full"})}),e.jsx("div",{className:"px-4 pb-4 pt-4",children:e.jsx(Ne,{analytics:v})}),e.jsx("div",{className:"px-4",children:e.jsx("div",{children:e.jsxs(p,{variant:"default",size:"lg",onClick:()=>a("/topics"),"aria-label":"View Test ArrowRight",className:"w-full rounded-xl font-bold",children:["Take a Test",e.jsx(ye,{className:"h-4 w-4 ml-2"})]})})}),e.jsx("div",{className:"px-4 mt-3 mb-4 ",children:e.jsx("div",{children:e.jsxs(p,{variant:"outline",size:"lg",onClick:()=>a("/topics"),"aria-label":"View Test History",className:"w-full rounded-xl border border-blue-500 bg-blue-50 text-blue-600",children:["View Test History",e.jsx(q,{className:"h-4 w-4 ml-2"})]})})}),e.jsxs("div",{className:"px-4 pb-4 pt-8",children:[e.jsx("h1",{className:"text-xl font-bold mb-4",children:"More from InzightEd"}),e.jsx(ve,{})]}),e.jsx(we,{type:"app"})]})]})]}),e.jsx(be,{})]})}export{Re as default};
