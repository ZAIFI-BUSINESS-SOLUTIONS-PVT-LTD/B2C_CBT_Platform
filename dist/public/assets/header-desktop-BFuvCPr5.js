import{d as m,u as y,r as c,ag as S,j as e,ah as k,ai as C,o as I,B as f,C as P,L as T,g as j,au as F,i as $,E as b,as as A}from"./main-CzoStkir.js";import{S as E}from"./profile-avatar-D9cO9Vj4.js";import{S as z}from"./scroll-area-WtX7C85G.js";import{N as H,F as L}from"./notepad-text-7swJf2ST.js";function M({item:s,currentPath:n,navigate:x}){const i=s.activePattern?s.activePattern.test(n):n===s.to,d=!!s.disabled,r=!!s.lockedForInstitution,a=d||r;return e.jsxs("li",{role:"none",className:"relative",children:[e.jsxs("button",{onClick:()=>{a||(s.onClick?s.onClick():x(s.to))},role:"menuitem","aria-label":s.text,"aria-disabled":a,disabled:a,className:`group w-full flex items-center rounded-lg transition-all duration-200 focus:outline-none px-4 py-3 text-left ${i?"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-600 font-medium shadow-sm":"text-gray-700 hover:bg-blue-50"} ${a?"filter blur-sm opacity-60 cursor-not-allowed":""}`,children:[e.jsx("div",{className:`flex items-center justify-center transition-colors duration-200 group-hover:text-blue-600 mr-3 ${i?"text-blue-600":"text-gray-600"} ${a?"text-gray-400":""}`,children:s.icon}),e.jsx("span",{className:"text-base whitespace-nowrap overflow-hidden flex-1",children:s.text}),s.expandable&&e.jsx("div",{className:`transition-colors duration-200 ${i?"text-blue-600":"text-gray-500"}`,children:s.expanded?e.jsx(F,{className:"h-4 w-4"}):e.jsx($,{className:"h-4 w-4"})})]}),r&&e.jsx("div",{className:"absolute top-2 right-2 bg-gray-800/80 rounded-full p-1.5",children:e.jsx(j,{className:"h-3 w-3 text-white"})})]})}function _(){const[,s]=m(),{student:n}=y(),[x,i]=c.useState([]),[d,r]=c.useState(new Set),[a,l]=c.useState(!1),p=()=>({Authorization:`Bearer ${A()}`,"Content-Type":"application/json"}),g=async()=>{try{const t=`${b.BASE_URL}${b.ENDPOINTS.CHAT_SESSIONS}`,o=await fetch(t,{headers:p()});if(o.ok){const w=(await o.json()).results||[];i(w)}else console.error("Failed to load sessions:",o.status)}catch(t){console.error("Failed to load chat sessions:",t)}};c.useEffect(()=>{g()},[]);const N="md:left-64";S();const h=!!(n!=null&&n.institution),v=[{to:"/",text:"Home",icon:e.jsx(k,{className:"h-5 w-5"}),activePattern:/^\/$/},{to:"/topics",text:"Test",icon:e.jsx(H,{className:"h-5 w-5"}),activePattern:/^\/topics/,lockedForInstitution:!0},{to:"/institution-tests",text:"Institution Tests",icon:e.jsx(C,{className:"h-5 w-5"}),activePattern:/^\/institution-tests/},{to:"/dashboard",text:"Analysis",icon:e.jsx(L,{className:"h-5 w-5"}),activePattern:/^\/dashboard/},{to:"/chatbot",text:"Chatbot",icon:e.jsx(I,{className:"h-5 w-5"}),activePattern:/^\/chatbot/,onClick:()=>{l(!0),setTimeout(()=>{l(!1),s("/dashboard")},1400),r(t=>new Set([...t,"chatbot"]))},expandable:!0,expanded:d.has("chatbot"),lockedForInstitution:!0}].filter(t=>!(t.text==="Institution Tests"&&!h)).map(t=>{const o={...t};return h&&t.lockedForInstitution?o.lockedForInstitution=!0:o.lockedForInstitution=!1,o}),[u]=m();return c.useEffect(()=>{u.startsWith("/chatbot")&&r(t=>new Set([...t,"chatbot"]))},[u]),e.jsxs(e.Fragment,{children:[e.jsx("header",{className:`flex items-center justify-end fixed top-0 ${N} right-0 z-50 h-20 bg-white border-b transition-all duration-300`,role:"banner",children:e.jsxs("div",{className:"flex items-center justify-end pr-3 space-x-3",children:[e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>s("/payment"),className:"aspect-square bg-orange-100 rounded-full h-12 w-12","aria-label":"Go to Payment",children:e.jsx(P,{className:"h-5 w-5 text-amber-600"})}),e.jsx(E,{})]})}),e.jsxs("aside",{className:"fixed top-0 left-0 h-full bg-white z-40 shadow-md overflow-hidden flex flex-col",style:{width:"256px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},"aria-label":"Main sidebar navigation",children:[e.jsx("div",{className:"flex items-center h-20 mb-2 border-b justify-start px-6",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("img",{src:T,alt:"InzightEd Logo",className:"h-9 pt-1"})})}),e.jsxs("nav",{className:"flex-1 flex flex-col justify-between overflow-y-auto py-4",children:[e.jsxs("div",{className:"px-3",children:[e.jsx("div",{className:"px-3 mb-4",children:e.jsx("span",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Main Menu"})}),e.jsx("ul",{className:"space-y-2",role:"menu",children:v.map(t=>e.jsx(M,{item:t,currentPath:u,navigate:s},t.to))}),d.has("chatbot")&&e.jsx("div",{className:"mt-2",children:e.jsx(z,{className:"max-h-40",children:e.jsx("div",{className:"space-y-1",children:x.map(t=>e.jsx("button",{onClick:()=>{l(!0),setTimeout(()=>{l(!1),s("/dashboard")},1400)},className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg truncate",children:t.sessionTitle||`Chat ${t.id}`},t.chatSessionId))})})})]}),e.jsx("div",{className:"mt-auto px-3",children:e.jsxs("div",{className:"flex items-center p-3 bg-blue-50 rounded-xl",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-medium text-sm",children:"U"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"User Name"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Role/Institution"})]})]})})]})]}),a&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>l(!1)}),e.jsx("div",{className:"relative bg-white rounded-2xl shadow-xl border border-gray-200 p-6 w-[90%] max-w-sm z-60",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-blue-50 flex items-center justify-center border border-blue-100",children:e.jsx(j,{className:"w-6 h-6 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Coming soon"}),e.jsx("p",{className:"text-sm text-gray-600 text-center",children:"The Chatbot is being rolled out soon. It will be available for students shortly."}),e.jsx("div",{className:"pt-2",children:e.jsx(f,{onClick:()=>l(!1),children:"Got it"})})]})})]})]})}export{_ as H};
