import{y as G,u as ee,a as se,af as re,r as o,A as u,j as e,f as y,X as ie,as as le,at as ce,x as te,S as W,aq as de,v as Z,I as he,au as me,s as ue,w as xe}from"./index-D0_LpoOS.js";import{S as ne}from"./scroll-area-CwidVopV.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],pe=G("ellipsis",fe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]],ae=G("file-pen",ge);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],be=G("menu",Ne);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Se=G("pencil",we);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ye=G("trash-2",je);function ve({sidebarOpen:w,currentSession:S,isLoading:M,onCloseSidebar:C,onCreateNewSession:I,onSwitchSession:m,onLoadSessionMessages:v,onSetCurrentSession:f,onSetSessions:i,onSetIsNewSession:d,onUpdateSessionTitle:p}){const{student:r}=ee(),[,l]=se(),q=re.useMemo(()=>{const t=r&&(r.fullName||r.email)||"";return t?t.split(" ").map(c=>c.charAt(0)).join("").toUpperCase().slice(0,2):"ST"},[r]),[L,z]=o.useState([]),[j,$]=o.useState(""),[E,F]=o.useState(!1),[T,O]=o.useState(null),[J,B]=o.useState(!1),[K,H]=o.useState(null);o.useEffect(()=>{const t=c=>{T&&!c.target.closest(".dropdown-container")&&O(null)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[T]),o.useEffect(()=>{w&&A()},[w]);const P=()=>({Authorization:`Bearer ${te()}`,"Content-Type":"application/json"}),A=async()=>{try{const t=`${u.BASE_URL}${u.ENDPOINTS.CHAT_SESSIONS}`,c=await fetch(t,{headers:P()});if(c.ok){const g=(await c.json()).results||[];if(z(g),i(g),g.length>0){if(!S){const R=g[0];f(R),R.chatSessionId?v(R.chatSessionId):console.error("chatSessionId is missing from session data")}}else f(null),d(!0)}else{const h=await c.text();console.error("Failed to load sessions:",c.status,h)}}catch(t){console.error("Failed to load chat sessions:",t)}},X=async()=>{try{await I(),C()}catch(t){console.error("Failed to create session:",t)}},D=t=>{m(t),C()},U=async(t,c)=>{F(!0);try{const h=`${u.BASE_URL}${u.ENDPOINTS.CHAT_SESSION_DETAIL(t.chatSessionId)}`;(await fetch(h,{method:"PATCH",headers:P(),body:JSON.stringify({session_title:c})})).ok?(z(R=>R.map(s=>s.chatSessionId===t.chatSessionId?{...s,sessionTitle:c}:s)),p(t.chatSessionId,c)):console.error("Failed to rename session title")}catch(h){console.error("Rename error",h)}finally{F(!1)}},Q=async t=>{if(window.confirm(`Are you sure you want to delete "${t.sessionTitle||`Chat ${t.id}`}"? This action cannot be undone.`))try{const h=`${u.BASE_URL}${u.ENDPOINTS.CHAT_SESSION_DETAIL(t.chatSessionId)}`;(await fetch(h,{method:"DELETE",headers:P()})).ok?(z(R=>R.filter(s=>s.chatSessionId!==t.chatSessionId)),(S==null?void 0:S.chatSessionId)===t.chatSessionId&&(f(null),d(!0))):(console.error("Failed to delete session"),alert("Failed to delete session. Please try again."))}catch(h){console.error("Delete error",h),alert("Failed to delete session. Please try again.")}};return w?e.jsxs("div",{className:"fixed inset-0 z-40",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:C}),e.jsx("div",{className:"relative z-50",children:e.jsxs("div",{className:"fixed left-0 top-0 h-full w-80 bg-white shadow-xl overflow-hidden transform transition-transform duration-300 ease-in-out flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-2 py-1 border-b border-[#E2E8F0] flex-shrink-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#1F2937]",children:"Chat Sessions"}),e.jsx(y,{onClick:C,variant:"ghost",size:"icon",className:"aspect-square hover:bg-[#F8FAFC] rounded-full transition-colors",children:e.jsx(ie,{className:"h-5 w-5 text-[#6B7280]"})})]}),e.jsxs("div",{className:"p-2 border-b border-[#E2E8F0] flex-shrink-0",children:[e.jsxs(y,{onClick:X,disabled:M,className:"w-full bg-[#4F83FF] hover:bg-[#3B82F6] text-white rounded-lg py-3 flex items-center justify-center gap-2 font-semibold text-base shadow-md",children:[e.jsx(ae,{className:"h-4 w-4"}),"New chat"]}),e.jsx("h1",{className:"mt-3 text-lg font-semibold text-[#1F2937]",children:"History"})]}),e.jsx(ne,{className:"flex-1 min-h-0",children:e.jsx("div",{className:"p-2 space-y-1",children:L.length===0?e.jsx("div",{className:"text-center py-8 text-[#6B7280] text-sm",children:"No chat sessions yet"}):L.map(t=>{const c=(S==null?void 0:S.chatSessionId)===t.chatSessionId,h=T===t.chatSessionId;return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:`cursor-pointer rounded-lg pl-4 hover:bg-[#F8FAFC] transition-colors font-medium text-sm ${c?"bg-[#E8F0FF] text-[#1F2937]":"text-[#6B7280]"} flex items-center justify-between gap-2`,onClick:()=>D(t),children:[e.jsx("div",{className:"flex-1 truncate",children:e.jsx("span",{className:"flex items-center gap-1 w-full",children:e.jsx("span",{className:"truncate max-w-[200px]",children:t.sessionTitle||`Chat ${t.id}`})})}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(y,{type:"button",variant:"ghost",size:"icon",className:"ml-1 flex-shrink-0 h-7 w-7 text-gray-300 hover:text-gray-500 hover:bg-[#F8FAFC]",title:"More options",onClick:g=>{g.stopPropagation(),O(h?null:t.chatSessionId)},children:e.jsx(pe,{className:"h-3.5 w-3.5"})})})]}),h&&e.jsxs("div",{className:"dropdown-container absolute right-2 top-full mt-1 bg-white border border-[#E2E8F0] rounded-lg shadow-lg z-10 min-w-[120px]",children:[e.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-[#6B7280] hover:bg-[#F8FAFC] hover:text-[#1F2937] flex items-center gap-2 border-b border-[#E2E8F0]",onClick:g=>{g.stopPropagation(),H(t),$(t.sessionTitle||""),B(!0),O(null)},children:[e.jsx(Se,{className:"h-3.5 w-3.5"}),"Rename"]}),e.jsxs("button",{className:"w-full px-3 py-2 text-left text-sm text-[#DC2626] hover:bg-[#FEF2F2] hover:text-[#B91C1C] flex items-center gap-2",onClick:g=>{g.stopPropagation(),Q(t),O(null)},children:[e.jsx(ye,{className:"h-3.5 w-3.5"}),"Delete"]})]})]},t.chatSessionId)})})}),e.jsx("div",{className:"flex-shrink-0 border-t border-[#E2E8F0] px-3 py-4 bg-white",children:e.jsxs(y,{onClick:()=>l("/dashboard"),className:"w-full flex items-center gap-3 p-3",variant:"ghost",children:[e.jsx(le,{className:"h-10 w-10",children:e.jsx(ce,{className:"bg-blue-600 text-white text-sm",children:q})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:(r==null?void 0:r.fullName)||"Student"}),e.jsx("div",{className:"text-xs text-[#6B7280] truncate",children:(r==null?void 0:r.email)||""})]})]})})]})}),J&&K&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>B(!1)}),e.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl p-6 w-full max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#1F2937] mb-4",children:"Rename Chat Session"}),e.jsx("input",{value:j,onChange:t=>$(t.target.value),className:"w-full px-3 py-2 border border-[#CBD5E1] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4F83FF] focus:border-transparent",placeholder:"Enter new title",maxLength:40,disabled:E}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(y,{onClick:()=>B(!1),variant:"outline",disabled:E,children:"Cancel"}),e.jsx(y,{onClick:async()=>{j.trim()&&!E&&(await U(K,j.trim()),B(!1),H(null))},disabled:E||!j.trim(),className:"bg-[#4F83FF] hover:bg-[#3B82F6] text-white",children:E?"Renaming...":"Rename"})]})]})]})]}):null}const Ee=`
  .safe-area-top {
    padding-top: env(safe-area-inset-top);
  }
  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }
  @media (max-width: 640px) {
    .chatbot-mobile-optimized {
      font-size: 14px;
    }
  }
  /* Prevent zoom on input focus on iOS */
  @media screen and (max-width: 767px) {
    input, textarea, select, button {
      font-size: 16px !important;
    }
  }
  /* Improve touch targets */
  button, .touch-target {
    min-height: 44px;
    min-width: 44px;
  }
`;function Fe({content:w,isUser:S}){const M=C=>C.split(`

`).map((m,v)=>{if(m.trim()==="")return null;if(m.includes("â€¢")||m.includes("*")||m.includes("-")){const i=m.split(`
`).filter(r=>r.trim()),d=[],p=[];return i.forEach(r=>{const l=r.trim();l.startsWith("â€¢")||l.startsWith("*")||l.startsWith("-")?d.push(l.replace(/^[â€¢*-]\s*/,"")):p.push(l)}),e.jsxs("div",{className:"mb-4 last:mb-0",children:[p.length>0&&e.jsx("div",{className:"mb-3",children:p.map((r,l)=>e.jsx("p",{className:"mb-2 last:mb-0",children:r},l))}),d.length>0&&e.jsx("ul",{className:"space-y-2 ml-0",children:d.map((r,l)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:`inline-block w-1.5 h-1.5 rounded-full mr-3 mt-2.5 flex-shrink-0 ${S?"bg-blue-200":"bg-gray-400"}`}),e.jsx("span",{className:"flex-1 leading-relaxed",children:r})]},l))})]},v)}if(m.includes(":")&&m.split(`
`).length===1){const i=m.split(":");if(i.length===2&&i[0].trim().length<50)return e.jsxs("div",{className:"mb-4 last:mb-0",children:[e.jsxs("h3",{className:`font-semibold mb-2 ${S?"text-blue-100":"text-gray-800"}`,children:[i[0].trim(),":"]}),e.jsx("p",{className:"leading-relaxed pl-2",children:i[1].trim()})]},v)}const f=m.split(`
`).filter(i=>i.trim());return e.jsx("div",{className:"mb-4 last:mb-0",children:f.map((i,d)=>e.jsx("p",{className:"mb-2 last:mb-0 leading-relaxed",children:i.trim()},d))},v)}).filter(Boolean);return e.jsx("div",{className:"space-y-0",children:M(w)})}function Ie(){const{isAuthenticated:w,student:S}=ee(),[,M]=se(),[C,I]=o.useState([]),[m,v]=o.useState(""),[f,i]=o.useState(!1),[d,p]=o.useState(null),[r,l]=o.useState(null),[q,L]=o.useState(!1),[z,j]=o.useState(!1),[$,E]=o.useState(null),[F,T]=o.useState(!1),[O,J]=o.useState(!1),[B,K]=o.useState(W.DEFAULT_LANGUAGE),H=o.useRef(null),P=o.useRef(null),A=o.useRef(null);o.useEffect(()=>{if(!w){M("/");return}},[w,M]),o.useEffect(()=>{X()},[C]),o.useEffect(()=>{if(!w)return;const s=new URLSearchParams(window.location.search),n=s.get("sessionId"),a=s.get("message");n&&a&&(window.history.replaceState({},"","/chatbot"),(async()=>{var N;try{const k=`${u.BASE_URL}${u.ENDPOINTS.CHAT_SESSIONS}`,_=await fetch(k,{headers:D()});if(_.ok){const b=(N=(await _.json()).results)==null?void 0:N.find(V=>V.chatSessionId===n);b?(p(b),j(!1),await U(b.chatSessionId),setTimeout(()=>{c(b,decodeURIComponent(a))},100)):(E(decodeURIComponent(a)),j(!0),p(null),I([]))}}catch(k){console.error("Failed to handle redirect message:",k)}})())},[w]),o.useEffect(()=>{const s=window.SpeechRecognition||window.webkitSpeechRecognition;if(s){J(!0);const n=new s;n.continuous=W.RECOGNITION_SETTINGS.continuous,n.interimResults=W.RECOGNITION_SETTINGS.interimResults,n.lang=B,n.maxAlternatives=W.RECOGNITION_SETTINGS.maxAlternatives,n.onresult=a=>{let x="";for(let N=0;N<a.results.length;N++)x+=a.results[N][0].transcript;v(x)},n.onstart=()=>{console.log("ðŸŽ¤ Speech recognition started"),T(!0)},n.onend=()=>{console.log("ðŸŽ¤ Speech recognition ended"),T(!1)},n.onerror=a=>{switch(console.error("ðŸŽ¤ Speech recognition error:",a.error),T(!1),a.error){case"no-speech":console.log("ðŸŽ¤ No speech detected");break;case"audio-capture":console.error("ðŸŽ¤ Audio capture failed - check microphone permissions");break;case"not-allowed":console.error("ðŸŽ¤ Microphone permission denied");break;case"network":console.error("ðŸŽ¤ Network error occurred");break;case"aborted":console.log("ðŸŽ¤ Speech recognition aborted");break;default:console.error("ðŸŽ¤ Unknown error:",a.error)}},n.onnomatch=()=>{console.log("ðŸŽ¤ No speech match found"),T(!1)},A.current=n}else console.warn("ðŸŽ¤ Speech Recognition not supported in this browser"),J(!1);return()=>{A.current&&A.current.abort()}},[B]);const X=()=>{var s;(s=H.current)==null||s.scrollIntoView({behavior:"smooth"})},D=()=>({Authorization:`Bearer ${te()}`,"Content-Type":"application/json"}),U=async s=>{try{if(!s||s==="undefined"){console.error("âŒ Invalid session ID:",s);return}const n=`${u.BASE_URL}${u.ENDPOINTS.CHAT_SESSION_MESSAGES(s)}`;console.log("ðŸ“¡ Fetching messages from:",n);const a=await fetch(n,{headers:D()});if(a.ok){const x=await a.json();I(x.messages||[])}else{const x=await a.text();console.error("Failed to load messages:",a.status,x)}}catch(n){console.error("Failed to load messages:",n)}};function Q(s){if(!s)return"New Chat";let n=s.trim();return n.length>30&&(n=n.slice(0,30).trim()+"..."),n.charAt(0).toUpperCase()+n.slice(1)}const t=async s=>{try{i(!0),p(null),I([]),j(!0),l(null),s&&typeof s=="string"&&s.trim()&&E(s.trim())}catch(n){l("Failed to start new chat session"),console.error("Failed to start session:",n)}finally{i(!1)}},c=async(s,n)=>{var x;l(null),i(!0);const a={id:`temp-${Date.now()}`,messageType:"user",messageContent:n,createdAt:new Date().toISOString()};I(N=>[...N,a]);try{const N=`${u.BASE_URL}${u.ENDPOINTS.CHAT_SESSION_SEND_MESSAGE(s.chatSessionId)}`;console.log("ðŸ“¤ Sending message to:",N);const k=await fetch(N,{method:"POST",headers:D(),body:JSON.stringify({message:n})});if(k.ok){const _=await k.json();I(b=>[...b.filter(oe=>oe.id!==a.id),{id:`user-${Date.now()}`,messageType:"user",messageContent:_.userMessage,createdAt:new Date().toISOString()},{id:`bot-${Date.now()}`,messageType:"bot",messageContent:_.botResponse,createdAt:new Date().toISOString()}]);const Y=Q(n);p(b=>b&&b.sessionTitle==="New Chat"?(fetch(`${u.BASE_URL}${u.ENDPOINTS.CHAT_SESSION_DETAIL(b.chatSessionId)}`,{method:"PATCH",headers:D(),body:JSON.stringify({session_title:Y})}).catch(V=>console.error("Failed to update session title:",V)),{...b,sessionTitle:Y}):b)}else{const _=await k.text();throw console.error("Failed to send message:",k.status,_),new Error("Failed to send message")}}catch(N){console.error("ðŸ’¥ Send message error:",N),l("Failed to send message. Please try again."),console.error("Failed to send message:",N),I(k=>k.filter(_=>_.id!==a.id))}finally{i(!1),(x=P.current)==null||x.focus()}},h=async()=>{const s=$||m.trim();if(!(!s||f)){if(E(null),v(""),j(!1),!d){try{i(!0);const n=`${u.BASE_URL}${u.ENDPOINTS.CHAT_SESSIONS}`,a=await fetch(n,{method:"POST",headers:D(),body:JSON.stringify({sessionTitle:"New Chat"})});if(a.ok){const x=await a.json();p(x),await c(x,s)}else{const x=await a.text();console.error("Failed to create session:",a.status,x),l("Failed to create session. Please try again.")}}catch(n){l("Failed to create session. Please try again."),console.error("Failed to create session:",n)}finally{i(!1)}return}if(!d.chatSessionId){console.error("âŒ Current session missing chatSessionId:",d),l("Invalid session. Please create a new session.");return}await c(d,s)}},g=s=>{p(s),j(!1),U(s.chatSessionId)},R=()=>{if(!O){console.warn("ðŸŽ¤ Speech recognition not supported");return}if(F)A.current&&A.current.stop(),setTimeout(()=>{m.trim()&&h()},100);else if(A.current)try{v(""),A.current.start()}catch(s){console.error("ðŸŽ¤ Failed to start speech recognition:",s),T(!1)}};return w?e.jsxs("div",{className:"flex flex-col h-screen bg-gradient-to-br from-sky-50 via-blue-50 to-indigo-50 overflow-hidden",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:Ee}}),e.jsx("div",{style:{paddingTop:"4px"},className:"bg-white",children:e.jsxs("div",{className:"bg-white flex items-center justify-between shadow-sm safe-area-top pl-2 pr-1 py-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(y,{variant:"ghost",size:"icon",onClick:()=>L(!q),className:"aspect-square rounded-full",children:e.jsx(be,{className:"h-6 w-6"})})}),e.jsx("h1",{className:"text-lg font-bold text-gray-800 tracking-tight",children:"InzightEd AI Assistant"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{variant:"ghost",size:"icon",onClick:()=>t(),title:"New Chat",className:"aspect-square rounded-full",disabled:f,children:e.jsx(ae,{className:"h-6 w-6"})}),e.jsx(y,{variant:"ghost",size:"icon",onClick:()=>M("/"),title:"Go to Home",className:"aspect-square rounded-full",children:e.jsx(de,{className:"h-6 w-6"})})]})]})}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(ne,{className:"h-full",children:e.jsx("div",{className:"max-w-full mx-auto px-3 py-4",children:!d||z?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[70vh] px-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-center",children:"Where should we begin?"}),e.jsx("p",{className:"text-md text-[#6B7280] text-center",children:"Ask me anything about your learning journey!"})]}):e.jsxs("div",{className:"space-y-4",children:[C.map((s,n)=>e.jsx("div",{className:`group relative flex ${s.messageType==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`flex items-start gap-3 max-w-[90%] ${s.messageType==="user"?"flex-row-reverse":""}`,children:e.jsx("div",{className:`rounded-xl px-3 pt-2 pb-1 text-sm shadow-sm border ${s.messageType==="user"?"bg-gradient-to-br from-blue-400 to-blue-600 text-white":"bg-white border-white transition-colors"}`,children:e.jsx(Fe,{content:s.messageContent,isUser:s.messageType==="user"})})})},s.id||n)),f&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"flex items-start gap-3",children:e.jsxs("div",{className:"rounded-xl px-4 py-3 bg-white text-[#1F2937] shadow-sm border border-[#E2E8F0] flex items-center gap-2",children:[e.jsx(Z,{className:"h-3.5 w-3.5 animate-spin text-[#4F83FF]"}),e.jsx("span",{className:"text-sm text-[#6B7280]",children:"Thinking..."})]})})}),e.jsx("div",{ref:H})]})})})}),e.jsx("div",{className:"bg-white border-t px-2 pt-2 pb-6",children:e.jsxs("div",{className:"w-full",children:[r&&e.jsx("div",{className:"mb-3 p-3 bg-[#FEF2F2] border border-[#FCA5A5] rounded-lg",children:e.jsx("p",{className:"text-sm text-[#DC2626]",children:r})}),e.jsx("form",{className:"w-full",onSubmit:s=>{s.preventDefault(),h()},children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx("div",{className:`flex-1 bg-[#F8FAFC] border border-[#E2E8F0] rounded-full transition-shadow duration-200 ${F?"ring-2 ring-[#10B981] ring-offset-2":""}`,children:e.jsx(he,{ref:P,value:$||m,onChange:s=>{$&&E(null),v(s.target.value)},onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),h())},placeholder:"Ask anything...",disabled:f,className:"w-full bg-transparent border-none outline-none shadow-none text-base placeholder-[#6B7280] rounded-full"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[O&&e.jsx(y,{type:"button",onClick:R,disabled:f,variant:"outline",size:"icon",className:`transition-all duration-200 ${F?"bg-[#10B981] hover:bg-[#059669] text-white border-[#10B981]":"bg-[#E5E7EB] hover:bg-[#CBD5E1] text-[#6B7280] border-[#E5E7EB]"} rounded-full`,title:F?"Stop recording and send":"Start voice input","aria-label":F?"Stop recording and send":"Start voice input",children:F?e.jsx(me,{className:"h-4 w-4"}):e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(y,{type:"submit",disabled:!(m.trim()||$)||f,size:"icon",className:"bg-[#4F83FF] hover:bg-[#3B82F6] text-white transition-all duration-200 disabled:opacity-50 rounded-full",children:f?e.jsx(Z,{className:"h-4 w-4 animate-spin"}):e.jsx(xe,{className:"h-4 w-4"})})]})]})}),O&&F&&e.jsx("div",{className:"mt-3 text-center",children:e.jsx("span",{className:"text-[#10B981] text-sm",children:"ðŸŽ¤ Listening... Click âœ“ to stop and send"})})]})})]}),e.jsx(ve,{sidebarOpen:q,currentSession:d,isLoading:f,onCloseSidebar:()=>L(!1),onCreateNewSession:t,onSwitchSession:g,onLoadSessionMessages:U,onSetCurrentSession:p,onSetSessions:()=>{},onSetIsNewSession:j,onUpdateSessionTitle:(s,n)=>{(d==null?void 0:d.chatSessionId)===s&&p(a=>a&&{...a,sessionTitle:n})}})]}):null}export{Ie as default};
