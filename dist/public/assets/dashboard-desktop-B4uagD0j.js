import{r as c,u as N,j as e,a as P,i as p,C as A,b as S,a0 as w,f as y,an as L,A as j,ao as E}from"./index-D0_LpoOS.js";import{T as I}from"./test-zone-insights-CeEQPQAC.js";import{H as g}from"./header-desktop-DRVedpQw.js";import{T as O}from"./trophy-DRb042JG.js";import{A as _}from"./arrow-right-CZqWqP1f.js";import"./target-hK32z5Hz.js";import"./profile-avatar-D3iRSJzO.js";import"./scroll-area-CwidVopV.js";import"./notepad-text-BSluFLZW.js";function F({analytics:a,insights:x,timeDistSubject:h,setTimeDistSubject:T}){var t;c.useState("Overall"),c.useState(!1);const[f,v]=c.useState(["All Subjects"]),[i,m]=c.useState("none");N(),[...((t=a.timeDistributionPast7)==null?void 0:t.subjects)||[]];const u=["All Subjects",...a.topicPerformance?[...new Set(a.topicPerformance.map(o=>o.subject))]:[]];return a.topicPerformance&&(()=>{const o=f.length===0?u:f;let l=o.includes("All Subjects")?a.topicPerformance:a.topicPerformance.filter(s=>o.includes(s.subject));return i==="accuracy-high-low"?l=l.sort((s,r)=>{const n=s.correctAnswers&&s.totalQuestions?s.correctAnswers/s.totalQuestions*100:0;return(r.correctAnswers&&r.totalQuestions?r.correctAnswers/r.totalQuestions*100:0)-n}):i==="accuracy-low-high"&&(l=l.sort((s,r)=>{const n=s.correctAnswers&&s.totalQuestions?s.correctAnswers/s.totalQuestions*100:0,d=r.correctAnswers&&r.totalQuestions?r.correctAnswers/r.totalQuestions*100:0;return n-d})),l})(),e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-full space-y-4",children:e.jsx(I,{})})})}function U(){const[a,x]=c.useState("All"),[h,T]=c.useState(null),[f,v]=c.useState("practice"),{isAuthenticated:i,loading:m,student:D}=N(),[,u]=P();if(c.useEffect(()=>{const n=d=>{d.preventDefault(),u("/",{replace:!0})};return window.history.pushState(null,"",window.location.href),window.addEventListener("popstate",n),()=>{window.removeEventListener("popstate",n)}},[u]),!m&&!i)return u("/"),null;const{data:t,isLoading:o,error:l}=p({queryKey:["/api/dashboard/comprehensive-analytics/"],refetchInterval:3e4,enabled:i&&!m}),{data:s,isLoading:r}=p({queryKey:["/api/insights/cache/"],refetchInterval:3e4,enabled:i&&!m});return p({queryKey:[j.ENDPOINTS.DASHBOARD_PLATFORM_TEST_ANALYTICS,h],queryFn:async()=>{const n=h?`${j.ENDPOINTS.DASHBOARD_PLATFORM_TEST_ANALYTICS}?test_id=${h}`:j.ENDPOINTS.DASHBOARD_PLATFORM_TEST_ANALYTICS,d=`${j.BASE_URL}${n}`,b=await E(d);if(!b.ok)throw new Error("Failed to fetch platform test analytics");return b.json()},enabled:i&&!m,refetchInterval:3e4}),c.useState("All"),o||r?e.jsx(k,{}):l||!t?e.jsx(C,{}):e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx(g,{}),e.jsx("main",{className:"flex-1 flex flex-col bg-gray-50 mt-24 mb-24 transition-all duration-300 md:ml-64",children:e.jsx("div",{className:"w-full max-w-7xl mx-auto px-4",children:e.jsx("div",{className:"md:flex md:items-start md:space-x-6",children:e.jsx("div",{className:"flex-1",children:e.jsx("div",{children:f==="practice"&&e.jsxs("div",{className:"space-y-4",children:[(t==null?void 0:t.totalTests)===0&&e.jsx(A,{className:"mt-4",children:e.jsxs(S,{className:"p-6 text-center",children:[e.jsx(O,{className:"h-10 w-10 text-yellow-500 mx-auto mb-2"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Tests Taken Yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Take your first test to see your performance analytics and unlock insights!"}),e.jsx(w,{href:"/topics",children:e.jsx(y,{className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Take a Test"})})]})}),s&&(t==null?void 0:t.totalTests)>0&&e.jsx(F,{analytics:t,insights:s,timeDistSubject:a,setTimeDistSubject:x})]})})})})})})]})}function k(){return e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx(g,{}),e.jsx("main",{className:"flex-1 flex flex-col bg-gray-50 mt-28 mb-24 transition-all duration-300 md:ml-64",children:e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-12 bg-gray-200 rounded-lg w-1/3"}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:[...Array(4)].map((a,x)=>e.jsx("div",{className:"h-24 bg-gray-200 rounded-lg"},x))}),e.jsxs("div",{className:"grid grid-cols-1 gap-8",children:[e.jsx("div",{className:"h-96 bg-gray-200 rounded-lg"}),e.jsx("div",{className:"h-96 bg-gray-200 rounded-lg"})]})]})})})]})}function C(){return e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx(g,{}),e.jsx("main",{className:"flex-1 flex flex-col bg-gray-50 mt-20 mb-24 transition-all duration-300 md:ml-64",children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsx(A,{className:"max-w-md w-full",children:e.jsxs(S,{className:"p-6 text-center",children:[e.jsx(L,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Unable to Load Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Take a practice test first to see your performance analytics."}),e.jsx(w,{href:"/topics",children:e.jsxs(y,{children:["Take Your First Test",e.jsx(_,{className:"h-4 w-4 ml-2"})]})})]})})})})]})}export{U as default};
