import{r as v,u as re,j as e,C as b,b as g,B as O,f as B,Z as xe,c as me,d as he,ad as ue,ae as V,af as Z,ag as X,ah as J,ai as Q,a as je,i as K,a0 as le,aj as fe,A as L,ak as be}from"./index-BEhJ738t.js";import{F as ge,R as H,B as Ne,C as pe,X as ye,L as D,Y as ve,T as Se,a as we,b as Ae,M as Te,c as Pe,P as ee,d as se,e as te}from"./filter-topic-performance-PbeakI_C.js";import{T as Y}from"./trophy-DV5qFwR-.js";import{T as Me}from"./target-D14vL6va.js";import{T as ke,A as Fe}from"./timer-BTlKaAgw.js";import{H as q}from"./header-desktop-CJMTT_kz.js";import"./profile-avatar-DFRGjmkV.js";import"./scroll-area-C9EE3XgK.js";import"./notepad-text-5UoVvSPz.js";const ce=["#3B82F6","#10B981","#F59E0B","#8B5CF6","#EF4444","#8B5CF6","#06B6D4","#84CC16"];function Ce({data:t}){return e.jsx("div",{className:"h-48",children:e.jsx(H,{width:"100%",height:"100%",children:e.jsxs(Ne,{data:t,margin:{top:20,right:30,bottom:5,left:30},children:[e.jsx(pe,{strokeDasharray:"2 2"}),e.jsx(ye,{dataKey:"testNumber",type:"number",domain:["dataMin","dataMax"],allowDecimals:!1,tickFormatter:n=>n!=null?`${n}`:"",fontSize:12,children:e.jsx(D,{value:"Practice test",offset:-5,position:"insideBottom",fontSize:12})}),e.jsx(ve,{fontSize:12,hide:!0,children:e.jsx(D,{value:"Accuracy (%)",angle:-90,position:"insideLeft",style:{textAnchor:"middle"},fontSize:12})}),e.jsx(Se,{labelFormatter:n=>n!=null?`Practice test ${n}`:"",contentStyle:{fontSize:"14px"}}),e.jsx(we,{dataKey:"accuracy",fill:"#3B82F6",barSize:20,radius:[4,4,0,0],children:e.jsx(Ae,{dataKey:"accuracy",position:"top",formatter:n=>`${n}%`,style:{fontSize:"12px",fontWeight:"bold",fill:"#0f172a"}})})]})})})}function $e({correct:t,incorrect:n,skipped:N}){const h=t+n+N,d=[{name:"Correct",value:t,color:"#10B981"},{name:"Incorrect",value:n,color:"#F59E0B"},{name:"Skipped",value:N,color:"#8B5CF6"}].filter(x=>x.value>0);return h===0?e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 160 160",className:"sm:w-44 sm:h-44",children:[e.jsxs("g",{children:[e.jsx("circle",{cx:"80",cy:"80",r:75,fill:"#f3f4f6"}),e.jsx("circle",{cx:"80",cy:"80",r:63,fill:"#fff"})]}),e.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",fontSize:"45",fill:"#0f172a",fontWeight:700,className:"sm:text-lg",children:"0"})]})}):e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 160 160",className:"sm:w-44 sm:h-44",children:[d.length===1?(()=>{const x=d[0];return e.jsxs("g",{children:[e.jsx("circle",{cx:"80",cy:"80",r:75,fill:x.color}),e.jsx("circle",{cx:"80",cy:"80",r:63,fill:"#fff"})]},x.name)})():d.map((x,u)=>{const j=d.slice(0,u).reduce(($,I)=>$+I.value,0),c=x.value/h,i=j/h*360-90,o=(j+x.value)/h*360-90,S=c>.5?1:0,p=75,y=63,A=80+p*Math.cos(i*Math.PI/180),F=80+p*Math.sin(i*Math.PI/180),C=80+p*Math.cos(o*Math.PI/180),k=80+p*Math.sin(o*Math.PI/180),w=80+y*Math.cos(o*Math.PI/180),T=80+y*Math.sin(o*Math.PI/180),P=80+y*Math.cos(i*Math.PI/180),z=80+y*Math.sin(i*Math.PI/180);return e.jsx("path",{d:`M ${A} ${F} A ${p} ${p} 0 ${S} 1 ${C} ${k} L ${w} ${T} A ${y} ${y} 0 ${S} 0 ${P} ${z} Z`,fill:x.color},x.name)}),e.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",fontSize:"45",fill:"#0f172a",fontWeight:700,className:"sm:text-lg",children:h})]})})}function Be({analytics:t,insights:n,timeDistSubject:N,setTimeDistSubject:h}){var W;const[d,x]=v.useState("Overall"),[u,j]=v.useState(!1),[c,i]=v.useState(["All Subjects"]),[o,S]=v.useState("none");re();const p=["Overall",...((W=t.timeDistributionPast7)==null?void 0:W.subjects)||[]],A=["All Subjects",...t.topicPerformance?[...new Set(t.topicPerformance.map(s=>s.subject))]:[]],F=(s,r)=>{i(s),S(r)},C=t.topicPerformance?(()=>{const s=c.length===0?A:c;let r=s.includes("All Subjects")?t.topicPerformance:t.topicPerformance.filter(l=>s.includes(l.subject));return o==="accuracy-high-low"?r=r.sort((l,a)=>{const m=l.correctAnswers&&l.totalQuestions?l.correctAnswers/l.totalQuestions*100:0;return(a.correctAnswers&&a.totalQuestions?a.correctAnswers/a.totalQuestions*100:0)-m}):o==="accuracy-low-high"&&(r=r.sort((l,a)=>{const m=l.correctAnswers&&l.totalQuestions?l.correctAnswers/l.totalQuestions*100:0,f=a.correctAnswers&&a.totalQuestions?a.correctAnswers/a.totalQuestions*100:0;return m-f})),r})():[],k=()=>{var s,r,l;if(d==="Overall"){const a=((s=t.subjectAccuracyPast7)==null?void 0:s.reduce((f,_)=>f+_.accuracy,0))||0,m=((r=t.subjectAccuracyPast7)==null?void 0:r.length)||0;return m>0?`${Math.round(a/m)}%`:"N/A"}else{const a=(l=t.subjectAccuracyPast7)==null?void 0:l.find(m=>m.subject===d);return a?`${Math.round(a.accuracy)}%`:"N/A"}},w=()=>{var a,m;const s=$();if(s>0&&t.totalTimeSpent)return`${Math.round(t.totalTimeSpent/s)}s`;let r;if(d==="Overall"?r=(a=t.timeDistributionPast7)==null?void 0:a.overall:r=(m=t.timeDistributionPast7)==null?void 0:m.bySubject[d],!r)return"N/A";const l=r.find(f=>f.status==="correct");return l?`${Math.round(l.avgTimeSec||l.timeSec||0)}s`:"N/A"},T=()=>{var U,G;let s;if(d==="Overall"?s=(U=t.timeDistributionPast7)==null?void 0:U.overall:s=(G=t.timeDistributionPast7)==null?void 0:G.bySubject[d],!s)return"N/A";const r=s.find(M=>M.status==="incorrect"),l=s.find(M=>M.status==="unattempted"),a=(r==null?void 0:r.avgTimeSec)||(r==null?void 0:r.timeSec)||0,m=(l==null?void 0:l.avgTimeSec)||(l==null?void 0:l.timeSec)||0,f=[a,m].filter(M=>M>0);if(f.length===0)return"N/A";const _=f.reduce((M,oe)=>M+oe,0)/f.length;return`${Math.round(_)}s`},P=s=>t.topicPerformance?(d==="Overall"?t.topicPerformance:t.topicPerformance.filter(l=>l.subject===d)).reduce((l,a)=>l+(s(a)||0),0):0,z=()=>{const s=k();if(!s||s==="N/A")return 0;const r=Number(String(s).replace("%",""));return isNaN(r)?0:Math.max(0,Math.min(1,r/100))},$=()=>P(s=>s.correctAnswers||0),I=()=>P(s=>(s.totalQuestions||0)-(s.correctAnswers||0)),ie=()=>0,ae=()=>String(I()),ne=()=>"0",de=()=>{var l,a,m;let s;if(d==="Overall"?s=(l=t.timeDistributionPast7)==null?void 0:l.overall:s=(m=(a=t.timeDistributionPast7)==null?void 0:a.bySubject)==null?void 0:m[d],!s)return"N/A";const r=s.find(f=>f.status==="unattempted"||f.status==="skipped");return r?`${Math.round(r.avgTimeSec??r.timeSec??0)}s`:"N/A"};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-full space-y-4",children:[e.jsx(b,{className:"bg-white rounded-2xl p-6 border",children:e.jsxs(g,{className:"p-0",children:[e.jsx("div",{className:"pb-3",children:e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:["Performance Overview ",e.jsx(O,{variant:"outline",className:"bg-blue-100 text-blue-600 border border-blue-600",children:"Past 7 tests"})]})}),e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"w-full mb-4 ",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"w-full flex items-center justify-start",children:e.jsx("div",{className:"flex gap-3 overflow-x-auto max-w-full hide-scrollbar",children:p.map(s=>e.jsx(B,{variant:s===d?"default":"outline",size:"default",className:"rounded-lg",onClick:()=>x(s),children:s},s))})}),e.jsx("div",{className:"bg-white w-full rounded-2xl pt-10 pb-4 px-3 space-y-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start justify-center gap-20",children:[e.jsxs("div",{className:"flex flex-col items-center mt-3",children:[e.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 160 160",className:"sm:w-44 sm:h-44",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"grad",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#2563eb"}),e.jsx("stop",{offset:"100%",stopColor:"#60a5fa"})]})}),e.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"#0f172a",strokeOpacity:"0.08",strokeWidth:"12",fill:"none"}),e.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"url(#grad)",strokeWidth:"12",strokeLinecap:"round",fill:"none",strokeDasharray:`${2*Math.PI*70}`,strokeDashoffset:`${2*Math.PI*70*(1-z())}`,transform:"rotate(-90 80 80)"}),e.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",fontSize:"45",fill:"#0f172a",fontWeight:700,className:"sm:text-xl",children:k()})]}),e.jsx("div",{className:"text-center mt-2",children:e.jsxs("div",{className:"text-xs sm:text-sm text-gray-600 font-medium",children:["Performance",e.jsx("br",{}),"Score"]})})]}),e.jsxs("div",{className:"flex flex-col items-center mt-3",children:[e.jsx($e,{correct:$(),incorrect:I(),skipped:ie()}),e.jsx("div",{className:"text-center mt-2",children:e.jsxs("div",{className:"text-xs sm:text-sm text-gray-600 font-medium",children:["Total Questions",e.jsx("br",{}),"Practiced"]})})]}),e.jsx("div",{className:"w-64 max-w-4xl",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"bg-white text-gray-800 rounded-xl p-2 shadow-md border border-green-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-lg font-bold mb-1",children:"Correct Answers"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-bold",children:"Time per question:"})," ",w()]})]}),e.jsx("div",{className:"text-3xl font-bold mr-4 ",children:String($())})]})}),e.jsx("div",{className:"bg-white text-gray-800 rounded-xl p-2 shadow-md border border-orange-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-lg font-bold mb-1",children:"Incorrect Answers"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-bold",children:"Time per question:"})," ",T()]})]}),e.jsx("div",{className:"text-3xl font-bold mr-4",children:ae()})]})}),e.jsx("div",{className:"bg-white text-gray-800 rounded-xl p-2 shadow-md border border-purple-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-lg font-bold mb-1",children:"Skipped Questions"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-bold",children:"Time per question:"})," ",de()]})]}),e.jsx("div",{className:"text-3xl font-bold mr-4",children:ne()})]})})]})})]})})]})})})]})}),e.jsx(b,{className:"bg-white rounded-2xl p-6 border",children:e.jsxs(g,{className:"p-0",children:[e.jsx("div",{className:"pb-2",children:e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:["Performance Score ",e.jsx(O,{variant:"outline",className:"bg-blue-100 text-blue-600 border border-blue-600",children:"Past 7 tests"})]})}),e.jsx("div",{className:"rounded-2xl px-2 py-4",children:e.jsx(Ce,{data:t.timeBasedTrends})})]})}),e.jsx(b,{className:"bg-white rounded-2xl p-4 border",children:e.jsxs(g,{className:"p-0",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xl font-bold px-0 md:px-2",children:["Topic Performance Score",e.jsx(O,{variant:"outline",className:"bg-blue-100 text-blue-600 border border-blue-600",children:"All tests"})]}),e.jsx("div",{className:"sticky top-14 z-40 -mx-3 mt-5 px-3 py-3 border-b border-gray-200 ",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium rounded-xl px-3 py-1",children:[e.jsx(xe,{className:"w-4 h-4"}),e.jsx("span",{children:"Filter"})]}),e.jsx("div",{className:"flex-1 overflow-x-auto hide-scrollbar",children:e.jsx("div",{className:"flex items-center gap-2 min-w-max",children:e.jsx("div",{className:"flex items-center gap-1",children:[{type:"sort",key:"accuracy-high-low",label:"High to low Performance",isSelected:o==="accuracy-high-low"},{type:"sort",key:"accuracy-low-high",label:"Low to high Performance",isSelected:o==="accuracy-low-high"},...A.map(s=>({type:"subject",key:s,label:s,isSelected:c.length===0&&s==="All Subjects"?!0:c.includes(s)}))].sort((s,r)=>s.isSelected&&!r.isSelected?-1:!s.isSelected&&r.isSelected?1:0).map(s=>s.type==="sort"?e.jsxs(B,{variant:s.isSelected?"default":"outline",size:"sm",onClick:()=>S(s.isSelected?"none":s.key),className:"rounded-lg text-xs px-3 py-1 flex items-center gap-1",children:[s.label,s.isSelected&&e.jsx("span",{className:"text-white hover:text-gray-200 cursor-pointer ml-1",onClick:r=>{r.stopPropagation(),S("none")},children:"×"})]},s.key):e.jsxs(B,{variant:s.isSelected?"default":"outline",size:"sm",onClick:()=>{s.key==="All Subjects"?i(["All Subjects"]):s.isSelected?i(r=>r.filter(l=>l!==s.key)):i(r=>r.filter(l=>l!=="All Subjects").concat(s.key))},className:"rounded-lg text-xs px-3 py-1 flex items-center gap-1 whitespace-nowrap",children:[s.label,s.isSelected&&s.key!=="All Subjects"&&e.jsx("span",{className:"text-white hover:text-gray-200 cursor-pointer ml-1",onClick:r=>{r.stopPropagation(),i(l=>l.filter(a=>a!==s.key))},children:"×"})]},s.key))})})})]})}),e.jsx(ge,{isOpen:u,onClose:()=>j(!1),subjects:A,currentFilter:c,currentSort:o,onApplyFilter:F}),e.jsx("div",{className:"relative px-0 md:px-2",children:t.topicPerformance&&t.topicPerformance.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:C.map((s,r)=>e.jsx(b,{className:"shadow-sm",children:e.jsxs(g,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-bold text-md",children:s.topic}),e.jsx(O,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:s.subject})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Accuracy"}),e.jsx("span",{className:"text-sm font-semibold",children:s.accuracy!=null?`${s.accuracy.toFixed(1)}%`:"N/A"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"h-3 rounded-full transition-all duration-300",style:{width:`${s.accuracy||0}%`,backgroundColor:ce[r%ce.length]}})})]})]})},s.topicId||s.topic))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No topic data yet. Take tests to populate topic performance."})})]})})]})})}const R=["#3B82F6","#10B981","#F59E0B","#8B5CF6"];function E({title:t,value:n,icon:N,color:h}){return e.jsx(b,{className:"bg-white shadow-md border border-[#E2E8F0] hover:shadow-lg transition-shadow",children:e.jsx(g,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-[#6B7280]",children:t}),e.jsx("p",{className:"text-2xl font-bold text-[#1F2937]",children:n})]}),e.jsx("div",{className:`p-3 rounded-full ${h} text-white shadow-md`,children:N})]})})})}function Ie({platformTestData:t,selectedPlatformTestId:n,setSelectedPlatformTestId:N,selectedTestSubjectFilter:h,setSelectedTestSubjectFilter:d}){var x,u,j;return t?e.jsxs("div",{className:"w-full space-y-6",children:[e.jsxs(b,{children:[e.jsxs(me,{children:[e.jsx(he,{children:"Platform Tests Analytics"}),e.jsx(ue,{children:"Select a platform test to view your performance metrics"})]}),e.jsx(g,{children:e.jsxs(V,{value:n||"",onValueChange:N,children:[e.jsx(Z,{className:"w-full",children:e.jsx(X,{placeholder:"Select a platform test..."})}),e.jsx(J,{children:t==null?void 0:t.availableTests.map(c=>e.jsxs(Q,{value:c.id.toString(),children:[c.testName," ",c.testYear&&`(${c.testYear})`]},c.id))})]})})]}),n&&(t==null?void 0:t.selectedTestMetrics)&&e.jsx(e.Fragment,{children:t.selectedTestMetrics.message?e.jsx(b,{children:e.jsx(g,{className:"p-6 text-center",children:e.jsx("p",{className:"text-gray-600",children:t.selectedTestMetrics.message})})}):t.selectedTestMetrics.error?e.jsx(b,{children:e.jsx(g,{className:"p-6 text-center",children:e.jsx("p",{className:"text-red-600",children:t.selectedTestMetrics.error})})}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(E,{title:"Overall Accuracy",value:`${t.selectedTestMetrics.overallAccuracy}%`,icon:e.jsx(Me,{className:"h-5 w-5"}),color:"bg-[#4F83FF]"}),e.jsx(E,{title:"Rank",value:t.selectedTestMetrics.rank?`${t.selectedTestMetrics.rank}/${t.selectedTestMetrics.totalStudents}`:"N/A",icon:e.jsx(Te,{className:"h-5 w-5"}),color:"bg-[#8B5CF6]"}),e.jsx(E,{title:"Percentile",value:t.selectedTestMetrics.percentile?`${t.selectedTestMetrics.percentile}%`:"N/A",icon:e.jsx(Pe,{className:"h-5 w-5"}),color:"bg-[#10B981]"}),e.jsx(E,{title:"Avg Time/Question",value:`${t.selectedTestMetrics.avgTimePerQuestion}s`,icon:e.jsx(ke,{className:"h-5 w-5"}),color:"bg-[#F59E0B]"})]})}),n&&(t==null?void 0:t.selectedTestMetrics)&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[e.jsxs("div",{className:"col-span-1 bg-white rounded-lg shadow p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Subject-wise Accuracy"}),t.selectedTestMetrics.subjectAccuracyForTest&&e.jsx(H,{width:"100%",height:200,children:e.jsx(ee,{children:e.jsx(se,{data:t.selectedTestMetrics.subjectAccuracyForTest.map(c=>({name:c.subject,value:c.accuracy||0})),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:70,label:!0,children:t.selectedTestMetrics.subjectAccuracyForTest.map((c,i)=>e.jsx(te,{fill:R[i%R.length]},`cell-${i}`))})})}),!t.selectedTestMetrics.subjectAccuracyForTest&&e.jsx("div",{className:"text-sm text-gray-500",children:"No subject-wise data available for this test."})]}),e.jsxs("div",{className:"col-span-2 bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium",children:"Time Distribution (s)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Subject:"}),e.jsxs(V,{value:h,onValueChange:d,children:[e.jsx(Z,{className:"w-32",children:e.jsx(X,{})}),e.jsxs(J,{children:[e.jsx(Q,{value:"All",children:"All"}),(u=(x=t.selectedTestMetrics.timeDistributionForTest)==null?void 0:x.subjects)==null?void 0:u.map(c=>e.jsx(Q,{value:c,children:c},c))]})]})]})]}),t.selectedTestMetrics.timeDistributionForTest&&e.jsx(H,{width:"100%",height:200,children:e.jsx(ee,{children:e.jsx(se,{data:(()=>{if(h==="All")return t.selectedTestMetrics.timeDistributionForTest.overall.map(i=>({name:i.status,value:i.timeSec}));const c=t.selectedTestMetrics.timeDistributionForTest.bySubject[h];return c?c.map(i=>({name:i.status,value:i.timeSec})):[]})(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:!0,children:t.selectedTestMetrics.timeDistributionForTest.overall.map((c,i)=>e.jsx(te,{fill:R[i%R.length]},`cell-time-${i}`))})})}),!t.selectedTestMetrics.timeDistributionForTest&&e.jsx("div",{className:"text-sm text-gray-500",children:"No timing breakdown available for this test."})]})]}),((j=t==null?void 0:t.selectedTestMetrics)==null?void 0:j.leaderboard)&&t.selectedTestMetrics.leaderboard.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Leaderboard"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Top ",t.selectedTestMetrics.leaderboard.length]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs text-gray-500 border-b",children:[e.jsx("th",{className:"py-2 px-3",children:"Rank"}),e.jsx("th",{className:"py-2 px-3",children:"Student"}),e.jsx("th",{className:"py-2 px-3",children:"Overall %"}),e.jsx("th",{className:"py-2 px-3",children:"Physics %"}),e.jsx("th",{className:"py-2 px-3",children:"Chemistry %"}),e.jsx("th",{className:"py-2 px-3",children:"Botany %"}),e.jsx("th",{className:"py-2 px-3",children:"Zoology %"}),e.jsx("th",{className:"py-2 px-3",children:"Time (s)"})]})}),e.jsx("tbody",{children:t.selectedTestMetrics.leaderboard.map(c=>e.jsxs("tr",{className:"text-sm border-b",children:[e.jsx("td",{className:"py-2 px-3",children:c.rank}),e.jsx("td",{className:"py-2 px-3",children:c.studentName||"Anonymous"}),e.jsx("td",{className:"py-2 px-3",children:c.accuracy!=null?`${c.accuracy.toFixed(2)}%`:"N/A"}),e.jsx("td",{className:"py-2 px-3",children:c.physics!=null?`${c.physics.toFixed(2)}%`:"N/A"}),e.jsx("td",{className:"py-2 px-3",children:c.chemistry!=null?`${c.chemistry.toFixed(2)}%`:"N/A"}),e.jsx("td",{className:"py-2 px-3",children:c.botany!=null?`${c.botany.toFixed(2)}%`:"N/A"}),e.jsx("td",{className:"py-2 px-3",children:c.zoology!=null?`${c.zoology.toFixed(2)}%`:"N/A"}),e.jsx("td",{className:"py-2 px-3",children:c.timeTakenSec!=null?c.timeTakenSec:"N/A"})]},`${c.studentId}-${c.rank}`))})]})})]}),!n&&e.jsx(b,{children:e.jsxs(g,{className:"p-8 text-center",children:[e.jsx(Y,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Platform Test Analytics"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Select a platform test above to view your detailed performance metrics including accuracy, rank, percentile, and timing."})]})})]}):e.jsx("div",{className:"w-full space-y-6",children:e.jsx(b,{children:e.jsxs(g,{className:"p-8 text-center",children:[e.jsx(Y,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Loading Platform Test Analytics"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we load your platform test data..."})]})})})}function We(){const[t,n]=v.useState("All"),[N,h]=v.useState(null),[d,x]=v.useState("practice"),{isAuthenticated:u,loading:j,student:c}=re(),[,i]=je();if(v.useEffect(()=>{const w=T=>{T.preventDefault(),i("/",{replace:!0})};return window.history.pushState(null,"",window.location.href),window.addEventListener("popstate",w),()=>{window.removeEventListener("popstate",w)}},[i]),!j&&!u)return i("/"),null;const{data:o,isLoading:S,error:p}=K({queryKey:["/api/dashboard/comprehensive-analytics/"],refetchInterval:3e4,enabled:u&&!j}),{data:y,isLoading:A}=K({queryKey:["/api/insights/cache/"],refetchInterval:3e4,enabled:u&&!j}),{data:F}=K({queryKey:[L.ENDPOINTS.DASHBOARD_PLATFORM_TEST_ANALYTICS,N],queryFn:async()=>{const w=N?`${L.ENDPOINTS.DASHBOARD_PLATFORM_TEST_ANALYTICS}?test_id=${N}`:L.ENDPOINTS.DASHBOARD_PLATFORM_TEST_ANALYTICS,T=`${L.BASE_URL}${w}`,P=await be(T);if(!P.ok)throw new Error("Failed to fetch platform test analytics");return P.json()},enabled:u&&!j,refetchInterval:3e4}),[C,k]=v.useState("All");return S||A?e.jsx(Oe,{}):p||!o?e.jsx(Le,{}):e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx(q,{}),e.jsx("main",{className:"flex-1 flex flex-col bg-gray-50 mt-24 mb-24 transition-all duration-300 md:ml-64",children:e.jsx("div",{className:"w-full max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"md:flex md:items-start md:space-x-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{children:d==="practice"&&e.jsxs("div",{className:"space-y-4",children:[(o==null?void 0:o.totalTests)===0&&e.jsx(b,{className:"mt-4",children:e.jsxs(g,{className:"p-6 text-center",children:[e.jsx(Y,{className:"h-10 w-10 text-yellow-500 mx-auto mb-2"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Tests Taken Yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Take your first test to see your performance analytics and unlock insights!"}),e.jsx(le,{href:"/topics",children:e.jsx(B,{className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Take a Test"})})]})}),y&&(o==null?void 0:o.totalTests)>0&&e.jsx(Be,{analytics:o,insights:y,timeDistSubject:t,setTimeDistSubject:n})]})})}),e.jsx("aside",{className:"hidden md:block w-80",children:e.jsx("div",{children:e.jsx(b,{className:"bg-white rounded-xl border mb-6",children:e.jsx(g,{className:"p-0",children:e.jsx(Ie,{platformTestData:F,selectedPlatformTestId:N,setSelectedPlatformTestId:h,selectedTestSubjectFilter:C,setSelectedTestSubjectFilter:k})})})})})]})})})]})}function Oe(){return e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx(q,{}),e.jsx("main",{className:"flex-1 flex flex-col bg-gray-50 mt-28 mb-24 transition-all duration-300 md:ml-64",children:e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-12 bg-gray-200 rounded-lg w-1/3"}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:[...Array(4)].map((t,n)=>e.jsx("div",{className:"h-24 bg-gray-200 rounded-lg"},n))}),e.jsxs("div",{className:"grid grid-cols-1 gap-8",children:[e.jsx("div",{className:"h-96 bg-gray-200 rounded-lg"}),e.jsx("div",{className:"h-96 bg-gray-200 rounded-lg"})]})]})})})]})}function Le(){return e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx(q,{}),e.jsx("main",{className:"flex-1 flex flex-col bg-gray-50 mt-20 mb-24 transition-all duration-300 md:ml-64",children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsx(b,{className:"max-w-md w-full",children:e.jsxs(g,{className:"p-6 text-center",children:[e.jsx(fe,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Unable to Load Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Take a practice test first to see your performance analytics."}),e.jsx(le,{href:"/topics",children:e.jsxs(B,{children:["Take Your First Test",e.jsx(Fe,{className:"h-4 w-4 ml-2"})]})})]})})})})]})}export{We as default};
