import{y as xe,r as y,u as ce,j as e,B as I,f as k,Z as me,C as v,b as S,ac as he,c as ue,d as je,ad as be,ae as V,af as Z,ag as X,ah as J,ai as K,a as ge,i as Y,a0 as le,aj as pe,A as O,ak as fe}from"./index-BEhJ738t.js";import{F as Ne,R as q,B as ye,C as ve,X as Se,L as D,Y as we,T as Ae,a as Te,b as Pe,M as ke,c as Me,P as ee,d as se,e as te}from"./filter-topic-performance-PbeakI_C.js";import{T as z}from"./trophy-DV5qFwR-.js";import{T as Fe}from"./target-D14vL6va.js";import{T as Ce,A as $e}from"./timer-BTlKaAgw.js";import{M as Be}from"./mobile-dock-C10klXz8.js";import"./notepad-text-5UoVvSPz.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]],Ie=xe("user-round",Le),re=["#3B82F6","#10B981","#F59E0B","#8B5CF6","#EF4444","#8B5CF6","#06B6D4","#84CC16"];function Oe({data:t}){return e.jsx("div",{className:"h-48",children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(ye,{data:t,margin:{top:20,right:30,bottom:5,left:30},children:[e.jsx(ve,{strokeDasharray:"2 2"}),e.jsx(Se,{dataKey:"testNumber",type:"number",domain:["dataMin","dataMax"],allowDecimals:!1,tickFormatter:n=>n!=null?`${n}`:"",fontSize:12,children:e.jsx(D,{value:"Practice test",offset:-5,position:"insideBottom",fontSize:12})}),e.jsx(we,{fontSize:12,hide:!0,children:e.jsx(D,{value:"Accuracy (%)",angle:-90,position:"insideLeft",style:{textAnchor:"middle"},fontSize:12})}),e.jsx(Ae,{labelFormatter:n=>n!=null?`Practice test ${n}`:"",contentStyle:{fontSize:"14px"}}),e.jsx(Te,{dataKey:"accuracy",fill:"#3B82F6",barSize:20,radius:[4,4,0,0],children:e.jsx(Pe,{dataKey:"accuracy",position:"top",formatter:n=>`${n}%`,style:{fontSize:"12px",fontWeight:"bold",fill:"#0f172a"}})})]})})})}function Ee({correct:t,incorrect:n,skipped:b}){const m=t+n+b,d=[{name:"Correct",value:t,color:"#10B981"},{name:"Incorrect",value:n,color:"#F59E0B"},{name:"Skipped",value:b,color:"#8B5CF6"}].filter(h=>h.value>0);return m===0?null:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 160 160",className:"sm:w-44 sm:h-44",children:[d.map((h,g)=>{const u=d.slice(0,g).reduce((_,$)=>_+$.value,0),r=h.value/m,a=u/m*360-90,o=(u+h.value)/m*360-90,w=r>.5?1:0,f=75,p=63,B=80+f*Math.cos(a*Math.PI/180),A=80+f*Math.sin(a*Math.PI/180),F=80+f*Math.cos(o*Math.PI/180),C=80+f*Math.sin(o*Math.PI/180),N=80+p*Math.cos(o*Math.PI/180),T=80+p*Math.sin(o*Math.PI/180),M=80+p*Math.cos(a*Math.PI/180),L=80+p*Math.sin(a*Math.PI/180);return e.jsx("path",{d:`M ${B} ${A} A ${f} ${f} 0 ${w} 1 ${F} ${C} L ${N} ${T} A ${p} ${p} 0 ${w} 0 ${M} ${L} Z`,fill:h.color},h.name)}),e.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",fontSize:"45",fill:"#0f172a",fontWeight:700,className:"sm:text-lg",children:m})]})})}function Re({analytics:t,insights:n,timeDistSubject:b,setTimeDistSubject:m}){var U;const[d,h]=y.useState("Overall"),[g,u]=y.useState(!1),[r,a]=y.useState(["All Subjects"]),[o,w]=y.useState("none"),{logout:f}=ce(),p=["Overall",...((U=t.timeDistributionPast7)==null?void 0:U.subjects)||[]],A=["All Subjects",...t.topicPerformance?[...new Set(t.topicPerformance.map(s=>s.subject))]:[]],F=(s,c)=>{a(s),w(c)},C=t.topicPerformance?(()=>{const s=r.length===0?A:r;let c=s.includes("All Subjects")?t.topicPerformance:t.topicPerformance.filter(l=>s.includes(l.subject));return o==="accuracy-high-low"?c=c.sort((l,i)=>{const x=l.correctAnswers&&l.totalQuestions?l.correctAnswers/l.totalQuestions*100:0;return(i.correctAnswers&&i.totalQuestions?i.correctAnswers/i.totalQuestions*100:0)-x}):o==="accuracy-low-high"&&(c=c.sort((l,i)=>{const x=l.correctAnswers&&l.totalQuestions?l.correctAnswers/l.totalQuestions*100:0,j=i.correctAnswers&&i.totalQuestions?i.correctAnswers/i.totalQuestions*100:0;return x-j})),c})():[],N=()=>{var s,c,l;if(d==="Overall"){const i=((s=t.subjectAccuracyPast7)==null?void 0:s.reduce((j,Q)=>j+Q.accuracy,0))||0,x=((c=t.subjectAccuracyPast7)==null?void 0:c.length)||0;return x>0?`${Math.round(i/x)}%`:"N/A"}else{const i=(l=t.subjectAccuracyPast7)==null?void 0:l.find(x=>x.subject===d);return i?`${Math.round(i.accuracy)}%`:"N/A"}},T=()=>{var i,x;const s=$();if(s>0&&t.totalTimeSpent)return`${Math.round(t.totalTimeSpent/s)}s`;let c;if(d==="Overall"?c=(i=t.timeDistributionPast7)==null?void 0:i.overall:c=(x=t.timeDistributionPast7)==null?void 0:x.bySubject[d],!c)return"N/A";const l=c.find(j=>j.status==="correct");return l?`${Math.round(l.avgTimeSec||l.timeSec||0)}s`:"N/A"},M=()=>{var W,G;let s;if(d==="Overall"?s=(W=t.timeDistributionPast7)==null?void 0:W.overall:s=(G=t.timeDistributionPast7)==null?void 0:G.bySubject[d],!s)return"N/A";const c=s.find(P=>P.status==="incorrect"),l=s.find(P=>P.status==="unattempted"),i=(c==null?void 0:c.avgTimeSec)||(c==null?void 0:c.timeSec)||0,x=(l==null?void 0:l.avgTimeSec)||(l==null?void 0:l.timeSec)||0,j=[i,x].filter(P=>P>0);if(j.length===0)return"N/A";const Q=j.reduce((P,oe)=>P+oe,0)/j.length;return`${Math.round(Q)}s`},L=s=>t.topicPerformance?(d==="Overall"?t.topicPerformance:t.topicPerformance.filter(l=>l.subject===d)).reduce((l,i)=>l+(s(i)||0),0):0,_=()=>{const s=N();if(!s||s==="N/A")return 0;const c=Number(String(s).replace("%",""));return isNaN(c)?0:Math.max(0,Math.min(1,c/100))},$=()=>L(s=>s.correctAnswers||0),H=()=>L(s=>(s.totalQuestions||0)-(s.correctAnswers||0)),ae=()=>0,ie=()=>String(H()),ne=()=>"0",de=()=>{var l,i,x;let s;if(d==="Overall"?s=(l=t.timeDistributionPast7)==null?void 0:l.overall:s=(x=(i=t.timeDistributionPast7)==null?void 0:i.bySubject)==null?void 0:x[d],!s)return"N/A";const c=s.find(j=>j.status==="unattempted"||j.status==="skipped");return c?`${Math.round(c.avgTimeSec??c.timeSec??0)}s`:"N/A"};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full space-y-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"pb-3",children:e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:["Performance Overview ",e.jsx(I,{variant:"outline",className:"bg-blue-100 text-blue-600 border border-blue-600",children:"Past 7 tests"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-full mb-4",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"w-full flex items-center justify-center",children:e.jsx("div",{className:"flex gap-3 overflow-x-auto max-w-full hide-scrollbar",children:p.map(s=>e.jsx(k,{variant:s===d?"default":"outline",size:"default",className:"rounded-lg",onClick:()=>h(s),children:s},s))})}),e.jsxs("div",{className:"bg-white w-full rounded-2xl pt-5 pb-4 px-3 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-center gap-10",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 160 160",className:"sm:w-44 sm:h-44",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"grad",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#2563eb"}),e.jsx("stop",{offset:"100%",stopColor:"#60a5fa"})]})}),e.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"#0f172a",strokeOpacity:"0.08",strokeWidth:"12",fill:"none"}),e.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"url(#grad)",strokeWidth:"12",strokeLinecap:"round",fill:"none",strokeDasharray:`${2*Math.PI*70}`,strokeDashoffset:`${2*Math.PI*70*(1-_())}`,transform:"rotate(-90 80 80)"}),e.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",fontSize:"45",fill:"#0f172a",fontWeight:700,className:"sm:text-xl",children:N()})]}),e.jsx("div",{className:"text-center mt-2",children:e.jsxs("div",{className:"text-xs sm:text-sm text-gray-600 font-medium",children:["Performance",e.jsx("br",{}),"Score"]})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Ee,{correct:$(),incorrect:H(),skipped:ae()}),e.jsx("div",{className:"text-center mt-2",children:e.jsxs("div",{className:"text-xs sm:text-sm text-gray-600 font-medium",children:["Total Questions",e.jsx("br",{}),"Practiced"]})})]})]}),e.jsx("div",{className:"w-full max-w-4xl",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"bg-white text-gray-800 rounded-xl p-2 shadow-md border border-green-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-lg font-bold mb-1",children:"Correct Answers"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-bold",children:"Time per question:"})," ",T()]})]}),e.jsx("div",{className:"text-3xl font-bold mr-4 ",children:String($())})]})}),e.jsx("div",{className:"bg-white text-gray-800 rounded-xl p-2 shadow-md border border-orange-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-lg font-bold mb-1",children:"Incorrect Answers"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-bold",children:"Time per question:"})," ",M()]})]}),e.jsx("div",{className:"text-3xl font-bold mr-4",children:ie()})]})}),e.jsx("div",{className:"bg-white text-gray-800 rounded-xl p-2 shadow-md border border-purple-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-lg font-bold mb-1",children:"Skipped Questions"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-bold",children:"Time per question:"})," ",de()]})]}),e.jsx("div",{className:"text-3xl font-bold mr-4",children:ne()})]})})]})})]})]})}),e.jsxs("div",{className:"w-full space-y-4",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold",children:["Performance Score ",e.jsx(I,{variant:"outline",className:"bg-blue-100 text-blue-600 border border-blue-600",children:"Past 7 tests"})]}),e.jsx("div",{className:"bg-white rounded-2xl px-2 py-4",children:e.jsx(Oe,{data:t.timeBasedTrends})}),e.jsxs("div",{className:"flex items-center gap-2 text-xl font-bold",children:["Topic Performance Score",e.jsx(I,{variant:"outline",className:"bg-blue-100 text-blue-600 border border-blue-600",children:"All tests"})]}),e.jsx("div",{className:"sticky top-14 z-40 -mx-3 px-3 py-3 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(k,{variant:"outline",size:"lg",onClick:()=>u(!g),className:"bg-white rounded-xl px-3 py-1 shadow-sm",children:[e.jsx(me,{className:"w-4 h-4"}),"Filter"]}),e.jsx("div",{className:"flex-1 overflow-x-auto hide-scrollbar",children:e.jsx("div",{className:"flex items-center gap-2 min-w-max",children:e.jsx("div",{className:"flex items-center gap-1",children:[{type:"sort",key:"accuracy-high-low",label:"High to low Performance",isSelected:o==="accuracy-high-low"},{type:"sort",key:"accuracy-low-high",label:"Low to high Performance",isSelected:o==="accuracy-low-high"},...A.map(s=>({type:"subject",key:s,label:s,isSelected:r.length===0&&s==="All Subjects"?!0:r.includes(s)}))].sort((s,c)=>s.isSelected&&!c.isSelected?-1:!s.isSelected&&c.isSelected?1:0).map(s=>s.type==="sort"?e.jsxs(k,{variant:s.isSelected?"default":"outline",size:"sm",onClick:()=>w(s.isSelected?"none":s.key),className:"rounded-lg text-xs px-3 py-1 flex items-center gap-1",children:[s.label,s.isSelected&&e.jsx("span",{className:"text-white hover:text-gray-200 cursor-pointer ml-1",onClick:c=>{c.stopPropagation(),w("none")},children:"×"})]},s.key):e.jsxs(k,{variant:s.isSelected?"default":"outline",size:"sm",onClick:()=>{s.key==="All Subjects"?a(["All Subjects"]):s.isSelected?a(c=>c.filter(l=>l!==s.key)):a(c=>c.filter(l=>l!=="All Subjects").concat(s.key))},className:"rounded-lg text-xs px-3 py-1 flex items-center gap-1 whitespace-nowrap",children:[s.label,s.isSelected&&s.key!=="All Subjects"&&e.jsx("span",{className:"text-white hover:text-gray-200 cursor-pointer ml-1",onClick:c=>{c.stopPropagation(),a(l=>l.filter(i=>i!==s.key))},children:"×"})]},s.key))})})})]})}),e.jsx(Ne,{isOpen:g,onClose:()=>u(!1),subjects:A,currentFilter:r,currentSort:o,onApplyFilter:F}),e.jsx("div",{className:"relative",children:t.topicPerformance&&t.topicPerformance.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:C.map((s,c)=>e.jsx(v,{className:"shadow-sm",children:e.jsxs(S,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-bold text-md",children:s.topic}),e.jsx(I,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:s.subject})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Accuracy"}),e.jsx("span",{className:"text-sm font-semibold",children:s.accuracy!=null?`${s.accuracy.toFixed(1)}%`:"N/A"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"h-3 rounded-full transition-all duration-300",style:{width:`${s.accuracy||0}%`,backgroundColor:re[c%re.length]}})})]})]})},s.topicId||s.topic))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No topic data yet. Take tests to populate topic performance."})})]})]})]})}),e.jsx("div",{className:"w-full flex justify-center mt-6",children:e.jsxs(k,{onClick:f,variant:"outline",className:"flex items-center gap-2 text-red-600 border-red-600 hover:bg-red-50",children:[e.jsx(he,{className:"h-4 w-4"}),"Logout"]})})]})}const E=["#3B82F6","#10B981","#F59E0B","#8B5CF6"];function R({title:t,value:n,icon:b,color:m}){return e.jsx(v,{className:"bg-white shadow-md border border-[#E2E8F0] hover:shadow-lg transition-shadow",children:e.jsx(S,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-[#6B7280]",children:t}),e.jsx("p",{className:"text-2xl font-bold text-[#1F2937]",children:n})]}),e.jsx("div",{className:`p-3 rounded-full ${m} text-white shadow-md`,children:b})]})})})}function ze({platformTestData:t,selectedPlatformTestId:n,setSelectedPlatformTestId:b,selectedTestSubjectFilter:m,setSelectedTestSubjectFilter:d}){var h,g,u;return t?e.jsxs("div",{className:"w-full space-y-6",children:[e.jsxs(v,{children:[e.jsxs(ue,{children:[e.jsx(je,{children:"Platform Tests Analytics"}),e.jsx(be,{children:"Select a platform test to view your performance metrics"})]}),e.jsx(S,{children:e.jsxs(V,{value:n||"",onValueChange:b,children:[e.jsx(Z,{className:"w-full",children:e.jsx(X,{placeholder:"Select a platform test..."})}),e.jsx(J,{children:t==null?void 0:t.availableTests.map(r=>e.jsxs(K,{value:r.id.toString(),children:[r.testName," ",r.testYear&&`(${r.testYear})`]},r.id))})]})})]}),n&&(t==null?void 0:t.selectedTestMetrics)&&e.jsx(e.Fragment,{children:t.selectedTestMetrics.message?e.jsx(v,{children:e.jsx(S,{className:"p-6 text-center",children:e.jsx("p",{className:"text-gray-600",children:t.selectedTestMetrics.message})})}):t.selectedTestMetrics.error?e.jsx(v,{children:e.jsx(S,{className:"p-6 text-center",children:e.jsx("p",{className:"text-red-600",children:t.selectedTestMetrics.error})})}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(R,{title:"Overall Accuracy",value:`${t.selectedTestMetrics.overallAccuracy}%`,icon:e.jsx(Fe,{className:"h-5 w-5"}),color:"bg-[#4F83FF]"}),e.jsx(R,{title:"Rank",value:t.selectedTestMetrics.rank?`${t.selectedTestMetrics.rank}/${t.selectedTestMetrics.totalStudents}`:"N/A",icon:e.jsx(ke,{className:"h-5 w-5"}),color:"bg-[#8B5CF6]"}),e.jsx(R,{title:"Percentile",value:t.selectedTestMetrics.percentile?`${t.selectedTestMetrics.percentile}%`:"N/A",icon:e.jsx(Me,{className:"h-5 w-5"}),color:"bg-[#10B981]"}),e.jsx(R,{title:"Avg Time/Question",value:`${t.selectedTestMetrics.avgTimePerQuestion}s`,icon:e.jsx(Ce,{className:"h-5 w-5"}),color:"bg-[#F59E0B]"})]})}),n&&(t==null?void 0:t.selectedTestMetrics)&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[e.jsxs("div",{className:"col-span-1 bg-white rounded-lg shadow p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Subject-wise Accuracy"}),t.selectedTestMetrics.subjectAccuracyForTest&&e.jsx(q,{width:"100%",height:200,children:e.jsx(ee,{children:e.jsx(se,{data:t.selectedTestMetrics.subjectAccuracyForTest.map(r=>({name:r.subject,value:r.accuracy||0})),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:70,label:!0,children:t.selectedTestMetrics.subjectAccuracyForTest.map((r,a)=>e.jsx(te,{fill:E[a%E.length]},`cell-${a}`))})})}),!t.selectedTestMetrics.subjectAccuracyForTest&&e.jsx("div",{className:"text-sm text-gray-500",children:"No subject-wise data available for this test."})]}),e.jsxs("div",{className:"col-span-2 bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium",children:"Time Distribution (s)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Subject:"}),e.jsxs(V,{value:m,onValueChange:d,children:[e.jsx(Z,{className:"w-32",children:e.jsx(X,{})}),e.jsxs(J,{children:[e.jsx(K,{value:"All",children:"All"}),(g=(h=t.selectedTestMetrics.timeDistributionForTest)==null?void 0:h.subjects)==null?void 0:g.map(r=>e.jsx(K,{value:r,children:r},r))]})]})]})]}),t.selectedTestMetrics.timeDistributionForTest&&e.jsx(q,{width:"100%",height:200,children:e.jsx(ee,{children:e.jsx(se,{data:(()=>{if(m==="All")return t.selectedTestMetrics.timeDistributionForTest.overall.map(a=>({name:a.status,value:a.timeSec}));const r=t.selectedTestMetrics.timeDistributionForTest.bySubject[m];return r?r.map(a=>({name:a.status,value:a.timeSec})):[]})(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:!0,children:t.selectedTestMetrics.timeDistributionForTest.overall.map((r,a)=>e.jsx(te,{fill:E[a%E.length]},`cell-time-${a}`))})})}),!t.selectedTestMetrics.timeDistributionForTest&&e.jsx("div",{className:"text-sm text-gray-500",children:"No timing breakdown available for this test."})]})]}),((u=t==null?void 0:t.selectedTestMetrics)==null?void 0:u.leaderboard)&&t.selectedTestMetrics.leaderboard.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Leaderboard"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Top ",t.selectedTestMetrics.leaderboard.length]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs text-gray-500 border-b",children:[e.jsx("th",{className:"py-2 px-3",children:"Rank"}),e.jsx("th",{className:"py-2 px-3",children:"Student"}),e.jsx("th",{className:"py-2 px-3",children:"Overall %"}),e.jsx("th",{className:"py-2 px-3",children:"Physics %"}),e.jsx("th",{className:"py-2 px-3",children:"Chemistry %"}),e.jsx("th",{className:"py-2 px-3",children:"Botany %"}),e.jsx("th",{className:"py-2 px-3",children:"Zoology %"}),e.jsx("th",{className:"py-2 px-3",children:"Time (s)"})]})}),e.jsx("tbody",{children:t.selectedTestMetrics.leaderboard.map(r=>e.jsxs("tr",{className:"text-sm border-b",children:[e.jsx("td",{className:"py-2 px-3",children:r.rank}),e.jsx("td",{className:"py-2 px-3",children:r.studentName||"Anonymous"}),e.jsx("td",{className:"py-2 px-3",children:r.accuracy!=null?`${r.accuracy.toFixed(2)}%`:"N/A"}),e.jsx("td",{className:"py-2 px-3",children:r.physics!=null?`${r.physics.toFixed(2)}%`:"N/A"}),e.jsx("td",{className:"py-2 px-3",children:r.chemistry!=null?`${r.chemistry.toFixed(2)}%`:"N/A"}),e.jsx("td",{className:"py-2 px-3",children:r.botany!=null?`${r.botany.toFixed(2)}%`:"N/A"}),e.jsx("td",{className:"py-2 px-3",children:r.zoology!=null?`${r.zoology.toFixed(2)}%`:"N/A"}),e.jsx("td",{className:"py-2 px-3",children:r.timeTakenSec!=null?r.timeTakenSec:"N/A"})]},`${r.studentId}-${r.rank}`))})]})})]}),!n&&e.jsx(v,{children:e.jsxs(S,{className:"p-8 text-center",children:[e.jsx(z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Platform Test Analytics"}),e.jsx("p",{className:"text-gray-600",children:"Select a platform test above to view your detailed performance metrics including accuracy, rank, percentile, and timing."})]})})]}):e.jsx("div",{className:"w-full space-y-6",children:e.jsx(v,{children:e.jsxs(S,{className:"p-8 text-center",children:[e.jsx(z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Loading Platform Test Analytics"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we load your platform test data..."})]})})})}function Ve(){const[t,n]=y.useState("All"),[b,m]=y.useState(null),[d,h]=y.useState("practice"),{isAuthenticated:g,loading:u,student:r}=ce(),[,a]=ge();if(y.useEffect(()=>{const N=T=>{T.preventDefault(),a("/",{replace:!0})};return window.history.pushState(null,"",window.location.href),window.addEventListener("popstate",N),()=>{window.removeEventListener("popstate",N)}},[a]),!u&&!g)return a("/"),null;const{data:o,isLoading:w,error:f}=Y({queryKey:["/api/dashboard/comprehensive-analytics/"],refetchInterval:3e4,enabled:g&&!u}),{data:p,isLoading:B}=Y({queryKey:["/api/insights/cache/"],refetchInterval:3e4,enabled:g&&!u}),{data:A}=Y({queryKey:[O.ENDPOINTS.DASHBOARD_PLATFORM_TEST_ANALYTICS,b],queryFn:async()=>{const N=b?`${O.ENDPOINTS.DASHBOARD_PLATFORM_TEST_ANALYTICS}?test_id=${b}`:O.ENDPOINTS.DASHBOARD_PLATFORM_TEST_ANALYTICS,T=`${O.BASE_URL}${N}`,M=await fe(T);if(!M.ok)throw new Error("Failed to fetch platform test analytics");return M.json()},enabled:g&&!u,refetchInterval:3e4}),[F,C]=y.useState("All");return w||B?e.jsx(_e,{}):f||!o?e.jsx(Qe,{}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-sky-50 via-blue-50 to-indigo-50 pb-20",children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"sticky top-0 bg-white z-10 border-b border-gray-200",children:[e.jsx("div",{className:"w-full mx-auto py-3 px-4 border-b border-gray-200 inline-flex items-center gap-3",children:e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Performance"})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex px-4","aria-label":"Tabs",children:[e.jsxs("button",{onClick:()=>h("practice"),className:`flex-1 flex items-center justify-center gap-2 py-4 px-2 border-b-2 font-medium text-sm transition-colors duration-200 active:bg-gray-50 ${d==="practice"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(Ie,{className:"h-4 w-4"}),e.jsx("span",{children:"Your Space"})]}),e.jsxs("button",{onClick:()=>h("battle"),className:`flex-1 flex items-center justify-center gap-2 py-4 px-2 border-b-2 font-medium text-sm transition-colors duration-200 active:bg-gray-50 ${d==="battle"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx("span",{children:"Battle Space"})]})]})})]}),e.jsxs("div",{className:"px-4 py-4",children:[d==="practice"&&e.jsxs("div",{className:"space-y-4",children:[(o==null?void 0:o.totalTests)===0&&e.jsx(v,{className:"mt-4",children:e.jsxs(S,{className:"p-6 text-center",children:[e.jsx(z,{className:"h-10 w-10 text-yellow-500 mx-auto mb-2"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Tests Taken Yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Take your first test to see your performance analytics and unlock insights!"}),e.jsx(le,{href:"/topics",children:e.jsx(k,{className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Take a Test"})})]})}),p&&(o==null?void 0:o.totalTests)>0&&e.jsx(Re,{analytics:o,insights:p,timeDistSubject:t,setTimeDistSubject:n})]}),d==="battle"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Battle Arena"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Compete with others in platform tests"})]}),e.jsx(ze,{platformTestData:A,selectedPlatformTestId:b,setSelectedPlatformTestId:m,selectedTestSubjectFilter:F,setSelectedTestSubjectFilter:C})]})]})]}),e.jsx(Be,{})]})}function _e(){return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-12 bg-gray-200 rounded-lg w-1/3"}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:[...Array(4)].map((t,n)=>e.jsx("div",{className:"h-24 bg-gray-200 rounded-lg"},n))}),e.jsxs("div",{className:"grid grid-cols-1 gap-8",children:[e.jsx("div",{className:"h-96 bg-gray-200 rounded-lg"}),e.jsx("div",{className:"h-96 bg-gray-200 rounded-lg"})]})]})})})}function Qe(){return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsx(v,{className:"max-w-md w-full",children:e.jsxs(S,{className:"p-6 text-center",children:[e.jsx(pe,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Unable to Load Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Take a practice test first to see your performance analytics."}),e.jsx(le,{href:"/topics",children:e.jsxs(k,{children:["Take Your First Test",e.jsx($e,{className:"h-4 w-4 ml-2"})]})})]})})})}export{Ve as default};
